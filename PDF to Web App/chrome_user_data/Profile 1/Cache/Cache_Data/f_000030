const __vite__fileDeps=["assets/AssignmentEventWorkPeriodForm-Dx6x-Hqu.js","assets/AssignmentEventWorkPeriodForm.vue_vue_type_script_setup_true_lang-BQXVvtSe.js","assets/vendor-DP6O45ke.js","assets/vendor-Bi5_IIMz.css","assets/index-CAoPmQlD.js","assets/ArtesaTimeInput.vue_vue_type_style_index_0_lang-LvzB_Px3.js","assets/index-wVhGhdDy.js","assets/index-Dsay-W0g.js","assets/index-DNLwZrWR.css","assets/ArtesaTimeInput-CqnzHY5J.css","assets/FeathersTablePagination.vue_vue_type_style_index_0_lang-BOkRBl1g.js","assets/GridTable.vue_vue_type_style_index_0_lang-D3VXJpla.js","assets/GridTable-MfZ2HMOu.css","assets/MakeSortable.vue_vue_type_script_setup_true_lang-7zyUd0na.js","assets/usePagination-Ryv7wWJy.js","assets/FeathersTablePagination-BvXyPM5N.css","assets/SelectUser.vue_vue_type_script_setup_true_lang-ecQ9vvXJ.js","assets/SelectAssignment.vue_vue_type_script_setup_true_lang-xX5XNIHx.js","assets/SelectAssignmentEvent.vue_vue_type_script_setup_true_lang-DblGRXhr.js","assets/assignment-events.helpers-CWYDlrj6.js","assets/stairs.helpers-BIn33vMK.js","assets/colorHelpers-Di3bZx5J.js","assets/AssignmentEventName.vue_vue_type_script_setup_true_lang-DS0TEwVk.js","assets/ArtesaDatePicker.vue_vue_type_style_index_0_lang-DcLt-5Pt.js","assets/ArtesaDatePicker-DVxGPBIb.css","assets/useContainerQuery-B2PH6oRc.js","assets/UnaccountablePeriodForm-BLLNWtML.js","assets/UnaccountablePeriodForm.vue_vue_type_script_setup_true_lang-5a1OHMXL.js","assets/SelectAssignmentEventType.vue_vue_type_script_setup_true_lang-1-5PYO1q.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{fJ as aa,fK as na,u as Ee,V as ht,Y as p,gw as $a,a as Xe,b as ut,o as l,az as W,h as r,f as n,g as T,t as f,c as e,e as w,j as S,aB as Se,i as $,e$ as It,l as mt,ff as Ot,gx as sa,gy as At,gz as Wt,gA as xt,ah as pe,e1 as Ke,e2 as $n,w as En,U as $e,X as In,ez as Ut,b0 as oa,eG as ra,eH as ia,f0 as la,eI as da,em as Qa,eS as Ea,f4 as On,r as ce,gf as Ya,eD as Zt,eA as Wn,gB as Ia,gC as Oa,gD as Wa,gE as xn,aO as Ka,aY as ze,aZ as gt,en as ua,gF as Un,fs as Nn,fa as Fn,f6 as Vn,m as ma,a$ as ft,a_ as ve,gG as xa,e6 as Hn,ae as Rn,fC as Ln,b4 as Xa,W as Pt,gH as qt,H as jt,_ as vt,gI as qn,k as zt,e3 as jn,gJ as zn,gK as Gn,z as Ua,fW as Qn,gL as Gt,D as Mt}from"./vendor-DP6O45ke.js";import{s as Na}from"./index-d9TNy9AD.js";import{e as Yn}from"./index-1M3isq4i.js";import{i as Jt}from"./index---ixMF9r.js";import{_ as Qe,f as Ce,s as Je,a as Fa}from"./ArtesaTimeInput.vue_vue_type_style_index_0_lang-LvzB_Px3.js";import{a as it,F as Ge,bn as Va,z as Ye,A as re,bo as Kn,D as _e,bp as ke,W as Ha,d as Za,ai as ca,aj as pa,a1 as Ja,V as ea,ae as Me,f as en,bq as tn,aZ as Xn,aY as Zn,br as Jn,bs as es,i as ts,t as as,bt as ns,y as ss,x as os,a_ as rs,s as is,v as ls,ba as ds,g as us,N as ms,bi as Ra,bk as La,bu as qa,bv as ja,a6 as cs}from"./index-Dsay-W0g.js";import{s as $t}from"./index-BcZtb1eP.js";import{u as ps,a as an,b as nn,t as fs}from"./shared-3KdztTy8.js";import{a as za}from"./index-DqnrlXPQ.js";import{i as vs}from"./index-CAoPmQlD.js";import{_ as Ne,a as fa}from"./InputWrapperGroup.vue_vue_type_script_setup_true_lang-3_0w4TEL.js";import{g as He}from"./users.helpers-iK3u8JSc.js";import{a as sn,g as ys}from"./user-absences.helpers-CF3rVBoR.js";import{_ as on}from"./GridTable.vue_vue_type_style_index_0_lang-D3VXJpla.js";import{d as yt}from"./timeTracking.store-Bco63arA.js";import{u as ta}from"./useIsUserOfRole-CsP1Paeq.js";import{f as rn}from"./FeathersTablePagination.vue_vue_type_style_index_0_lang-BOkRBl1g.js";import{u as ln}from"./hasItemsForCompany.store-B-Xh4q3W.js";import{u as dn}from"./validateFormAsync-7W-wrk_Q.js";import{i as hs}from"./index-C8ho11FL.js";import{t as gs}from"./index-CsgZOv_I.js";import{a as As,u as bs,F as ks}from"./useFullcalendar-CLA5ahNS.js";import{a as Bt}from"./index-5ygR7EGk.js";import{_ as Ss}from"./AssignmentEventWorkPeriodForm.vue_vue_type_script_setup_true_lang-BQXVvtSe.js";import{a as ws}from"./UnaccountablePeriodForm.vue_vue_type_script_setup_true_lang-5a1OHMXL.js";import{g as Ds,d as Ts}from"./assignment-events.helpers-CWYDlrj6.js";import{_ as _s}from"./AssignmentEventName.vue_vue_type_script_setup_true_lang-DS0TEwVk.js";import{u as Ms,_ as Bs}from"./useAssignmentEventsWithEventUsers-BSNPqUuH.js";import{_ as Ps}from"./ArtesaTimePickerForCalendar.vue_vue_type_style_index_0_lang-Bin9FMqz.js";import{_ as Cs}from"./PopperSelectUserSingle.vue_vue_type_script_setup_true_lang-DBzr1iiR.js";import{a as $s}from"./useIdObjectMapper-Czi98NfK.js";import{u as Es}from"./useCSVStringify-Bd1XxEVT.js";import"./index-wVhGhdDy.js";import"./colorHelpers-Di3bZx5J.js";import"./computedDebounced-DaN6cEOJ.js";import"./useRole-C0PbMcty.js";import"./MakeSortable.vue_vue_type_script_setup_true_lang-7zyUd0na.js";import"./usePagination-Ryv7wWJy.js";import"./index-DuDPwDMn.js";import"./SelectUser.vue_vue_type_script_setup_true_lang-ecQ9vvXJ.js";import"./SelectAssignment.vue_vue_type_script_setup_true_lang-xX5XNIHx.js";import"./SelectAssignmentEvent.vue_vue_type_script_setup_true_lang-DblGRXhr.js";import"./ArtesaDatePicker.vue_vue_type_style_index_0_lang-DcLt-5Pt.js";import"./useContainerQuery-B2PH6oRc.js";import"./SelectAssignmentEventType.vue_vue_type_script_setup_true_lang-1-5PYO1q.js";import"./stairs.helpers-BIn33vMK.js";import"./chat.store-WmbfM-QW.js";import"./index-CJWmrMZX.js";import"./ArtesaProfilePicture.vue_vue_type_script_setup_true_lang-NQqm-LCY.js";import"./PopperFeathersItems.vue_vue_type_script_setup_true_lang-Dj8XPvGz.js";function Is(h){aa(1,arguments);var u=na(h),t=u.getDay();return t}function Qt(h){h.declinedAt&&(h.declinedAt=null),h.declinedById&&(h.declinedById=null),h.declinedNote&&(h.declinedNote=null)}function Yt(h){h.approvedAt&&(h.approvedAt=null),h.approvedById&&(h.approvedById=null)}function Os(){const h=it();function u(g,y){const k=y??new Date;if(Array.isArray(g))return g.map(_=>u(_,k)).filter(Ge);const o=g;if(!(o.submittedAt||o.approvedAt))return Yt(o),Qt(o),o.submittedAt=k,o}function t(g){if(Array.isArray(g))return g.map(k=>t(k)).filter(Ge);const y=g;if(y.submittedAt)return Yt(y),Qt(y),y.submittedAt=null,y}function B(g,y){const k=y??new Date;if(Array.isArray(g))return g.map(_=>B(_,k)).filter(Ge);const o=g;if(!o.approvedAt)return o.submittedAt||(o.submittedAt=k),Qt(o),o.approvedAt=k,o.approvedBy=h.value,o}function v(g,y,k){const o=k??new Date;if(Array.isArray(g))return g.map(I=>v(I,y,o)).filter(Ge);const _=g;if(!_.declinedAt)return _.submittedAt&&(_.submittedAt=null),Yt(_),_.declinedAt=o,_.declinedBy=h.value,y?_.declinedNote=y:_.declinedNote=null,_}return{submit:u,unsubmit:t,approve:B,decline:v}}function va(){const{t:h}=Ee();return{getSubmittedMessage:y=>{if(!y?.submittedAt)return"";const k=Ye(y.submittedAt);return h("timeSheets.submittedAt",{date:k})},getDeclinedMessage:y=>{if(!y?.declinedAt)return"";const[k,o]=Va(y.declinedAt);return y.declinedBy?o==="date"?h("timeSheets.declinedByAt",{user:He(y.declinedBy),date:k}):h("timeSheets.declinedByAtTime",{user:He(y.declinedBy),time:k}):o==="date"?h("timeSheets.declinedAt",{date:k}):h("timeSheets.declinedAtTime",{time:k})},getApprovedMessage:y=>{if(!y?.approvedAt)return"";const k=Ye(y.approvedAt);return y.approvedBy?h("timeSheets.approvedByAt",{user:He(y.approvedBy),date:k}):h("timeSheets.approvedAt",{date:k})},getAtByMessage:(y,k)=>{if(!y)return"";const[o,_]=Va(y);return k?_==="date"?h("timeSheets.byAt",{user:He(k),date:o}):h("timeSheets.byAtTime",{user:He(k),time:o}):_==="date"?h("timeSheets.at",{date:o}):h("timeSheets.atTime",{time:o})},getByMessage:y=>y?h("timeSheets.by",{user:He(y)}):""}}function ya(h){const{t:u}=Ee(),t=ht(h),B=p(()=>t.value?.declinedAt?t.value.declinedBy?u("timeSheets.DeclinedBy",{user:He(t.value.declinedBy)}):u("timeSheets.Declined"):""),v=p(()=>{if(!t.value?.declinedAt)return"";const k=Ye(t.value.declinedAt);return t.value.declinedBy?u("timeSheets.declinedByAt",{user:He(t.value.declinedBy),date:k}):u("timeSheets.declinedAt",{date:k})}),g=p(()=>{if(!t.value?.approvedAt)return"";const k=Ye(t.value.approvedAt);return t.value.approvedBy?u("timeSheets.approvedByAt",{user:He(t.value.approvedBy),date:k}):u("timeSheets.approvedAt",{date:k})});return{submittedAtMessage:p(()=>{if(!t.value?.submittedAt)return"";const k=Ye(t.value.submittedAt);return u("timeSheets.submittedAt",{date:k})}),declinedAtMessage:v,approvedAtMessage:g,declinedMessage:B}}function Kt(h){h.declinedAt&&(h.declinedAt=null),h.declinedById&&(h.declinedById=null),h.declinedNote&&(h.declinedNote=null)}function Xt(h){h.approvedAt&&(h.approvedAt=null),h.approvedById&&(h.approvedById=null)}function Ws(){const h=it();function u(g){if(!(g.submittedAt||g.approvedAt))return Xt(g),Kt(g),g.submittedAt=new Date,g}function t(g){if(g.submittedAt)return Xt(g),Kt(g),g.submittedAt=null,g}function B(g){if(!g.approvedAt)return g.submittedAt||(g.submittedAt=new Date),Kt(g),g.approvedAt=new Date,g.approvedBy=h.value,g}function v(g,y){if(!g.declinedAt)return g.submittedAt&&(g.submittedAt=null),Xt(g),g.declinedAt=new Date,g.declinedBy=h.value,y?g.declinedNote=y:g.declinedNote=null,g}return{submit:u,unsubmit:t,approve:B,decline:v}}function xs(h){const u=ht(h.month),t=ht(h.timeSheetDays),{t:B}=Ee(),{getDeclinedMessage:v}=va(),g=p(()=>{if(!u.value.declinedAt&&t.value.every(k=>!k.declinedAt))return"";if(u.value.declinedAt){const k=Ye(u.value.declinedAt);return u.value.declinedBy?B("timeSheets.declinedByAt",{user:u.value.declinedBy.shortName||u.value.declinedBy.fullName,date:k}):B("timeSheets.declinedAt",{date:k})}else{const k=$a(t.value.filter(o=>!!o.declinedAt),["declinedAt"],["desc"]);return v(k[0])}});return{approvedAtMessage:p(()=>{if(!u.value.approvedAt&&t.value.some(k=>!k.approvedAt))return"";if(u.value.approvedAt){const k=Ye(u.value.approvedAt);return u.value.approvedBy?B("timeSheets.approvedByAt",{user:u.value.approvedBy.shortName||u.value.approvedBy.fullName,date:k}):B("timeSheets.approvedAt",{date:k})}else{const k=$a(t.value.filter(o=>!!o.approvedAt),["declinedAt"],["desc"]);return v(k[0])}}),declinedAtMessage:g}}const Us={class:"flex flex-wrap gap-2"},Ns={class:"flex flex-wrap flex-1 gap-1"},Fs={class:"leading-loose"},Vs={class:"leading-loose"},Hs={key:0,class:"text-gray-400 text-xs flex py-1 leading-none"},Rs={class:"leading-loose"},Ls={key:0,class:"text-gray-400 text-xs flex py-1 leading-none"},qs={key:3,class:"flex border-l border-slate-300 pl-1"},js={class:"leading-loose"},zs={class:"flex flex-wrap gap-1"},Gs={key:0,class:"flex items-center"},Qs={key:0,class:"text-sm text-danger ml-1"},Ys=Xe({__name:"TimeSheetMonthOverview",props:{timeSheetMonth:{},calculatedSumActual:{},calculatedSumTarget:{},calculatedCarryOverBefore:{},calculatedCarryOverAfter:{},calculatedSumActualAndPlanned:{},dayData:{},actions:{},canEdit:{type:Boolean},canReset:{type:Boolean},workingTimeModel:{}},emits:["submitAll","approveAll","declineAll","unsubmitAll","reset"],setup(h,{emit:u}){const t=h,B=u,{t:v}=Ee();function g(o){t.timeSheetMonth.carryOverBeforeManipulatedAt||(t.timeSheetMonth.carryOverBeforeManipulatedAt=new Date),t.timeSheetMonth.carryOverBefore=o}const{declinedAtMessage:y,approvedAtMessage:k}=xs({month:p(()=>t.timeSheetMonth),timeSheetDays:p(()=>t.dayData.map(o=>o.timeSheetDay))});return(o,_)=>{const I=ut("i18n-t"),V=It,j=mt,R=Ot;return l(),W("div",null,[r(fa,{class:"bg-gray-100 p-2 rounded shadow flex-col"},{default:n(()=>[T("div",Us,[T("div",Ns,[r(Ne,{title:o.$t("timeSheets.monthsOverview.sumActual"),class:"w-[4.5rem]"},{default:n(()=>[T("div",Fs,f(e(Ce)(o.calculatedSumActual)),1)]),_:1},8,["title"]),o.calculatedSumTarget!==void 0?(l(),w(Ne,{key:0,title:o.$t("timeSheets.monthsOverview.sumTarget"),class:"w-[4.5rem]"},{default:n(()=>[T("div",Vs,f(e(Ce)(o.calculatedSumTarget)),1)]),_:1},8,["title"])):S("",!0),o.calculatedCarryOverBefore!==void 0?(l(),w(Ne,{key:1,title:o.$t("timeSheets.monthsOverview.carryOverBefore"),class:"w-20"},{default:n(()=>[r(Qe,{"model-value":o.timeSheetMonth.carryOverBefore,"value-type":"hours",disabled:!o.canEdit,class:Se(["!w-full",{"inline-edit [&_input]:!cursor-default":!o.canEdit}]),"onUpdate:modelValue":g},null,8,["model-value","disabled","class"]),o.calculatedCarryOverBefore!==void 0&&o.timeSheetMonth.carryOverBefore!==o.calculatedCarryOverBefore?(l(),W("div",Hs,[r(I,{keypath:"timeSheets.monthsOverview.calculated",scope:"global"},{calc:n(()=>[$(f(e(Ce)(o.calculatedCarryOverBefore)),1)]),_:1})])):S("",!0)]),_:1},8,["title"])):S("",!0),o.calculatedCarryOverAfter!==void 0?(l(),w(Ne,{key:2,title:o.$t("timeSheets.monthsOverview.carryOverAfter"),class:"w-20"},{default:n(()=>[T("div",Rs,f(e(Ce)(o.timeSheetMonth.carryOverAfter??0)),1),o.calculatedCarryOverAfter!==void 0&&o.timeSheetMonth.carryOverAfter!==o.calculatedCarryOverAfter?(l(),W("div",Ls,[r(I,{keypath:"timeSheets.monthsOverview.calculated",scope:"global"},{calc:n(()=>[$(f(e(Ce)(o.calculatedCarryOverAfter)),1)]),_:1})])):S("",!0)]),_:1},8,["title"])):S("",!0),o.calculatedSumActualAndPlanned!==void 0&&o.calculatedSumTarget!==void 0?(l(),W("div",qs,[r(Ne,{title:o.$t("timeSheets.monthsOverview.currentDifference"),class:"w-20"},{default:n(()=>[T("div",js,f(e(Ce)((o.calculatedSumActualAndPlanned??0)-(o.calculatedSumTarget??0)+(o.calculatedCarryOverBefore??0))),1)]),_:1},8,["title"])])):S("",!0)]),T("div",zs,[o.canReset?(l(),w(re,{key:0,content:e(v)("actions.reset")},{default:n(()=>[r(j,{onClick:_[0]||(_[0]=()=>B("reset"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(sa))]),_:1})]),_:1})]),_:1},8,["content"])):S("",!0),o.actions.canSubmit?(l(),w(re,{key:1,content:e(v)("timeSheets.submitAll")},{default:n(()=>[r(j,{type:"primary",class:"allow-cursor",onClick:_[1]||(_[1]=()=>B("submitAll"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(At))]),_:1})]),_:1})]),_:1},8,["content"])):S("",!0),o.actions.canApprove?(l(),w(re,{key:2,content:e(v)("timeSheets.approveAll")},{default:n(()=>[r(j,{type:"primary",plain:!!o.actions.timeSheetsToSubmit.length,disabled:!o.actions.timeSheetsToApprove.length,class:"allow-cursor",onClick:_[2]||(_[2]=()=>B("approveAll"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(Wt))]),_:1})]),_:1},8,["plain","disabled"])]),_:1},8,["content"])):S("",!0),o.actions.canDecline?(l(),w(re,{key:3,content:e(v)("timeSheets.declineAll")},{default:n(()=>[r(j,{type:"danger",plain:!!o.actions.timeSheetsToSubmit.length||!o.actions.timeSheetsToDecline.length,disabled:!o.actions.timeSheetsToDecline.length,class:"allow-cursor",onClick:_[3]||(_[3]=()=>B("declineAll"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(xt))]),_:1})]),_:1},8,["plain","disabled"])]),_:1},8,["content"])):S("",!0)])]),T("div",null,[o.dayData.some(c=>!!c.timeSheetDay.declinedAt)||o.timeSheetMonth.declinedAt?(l(),W("div",Gs,[r(re,{content:e(y)},{default:n(()=>[r(R,{type:"danger"},{default:n(()=>[$(f(e(v)("timeSheets.declined")),1)]),_:1})]),_:1},8,["content"]),o.timeSheetMonth.declinedAt&&o.timeSheetMonth.declinedNote?(l(),W("div",Qs,f(e(v)("timeSheets.monthsOverview.declineReason",{user:e(He)(o.timeSheetMonth.declinedBy),reason:o.timeSheetMonth.declinedNote})),1)):S("",!0)])):o.dayData.every(c=>!!c.timeSheetDay.approvedAt)||o.timeSheetMonth.approvedAt?(l(),w(re,{key:1,content:e(k)},{default:n(()=>[r(R,{type:"success"},{default:n(()=>[$(f(e(v)("timeSheets.approved")),1)]),_:1})]),_:1},8,["content"])):o.dayData.every(c=>!!c.timeSheetDay.submittedAt)?(l(),w(R,{key:2,type:"info"},{default:n(()=>[$(f(e(v)("timeSheets.submitted")),1)]),_:1})):(l(),w(R,{key:3,type:"warning"},{default:n(()=>[$(f(e(v)("timeSheets.notSubmittedYet")),1)]),_:1}))])]),_:1})])}}}),Et=Xe({__name:"TimeSheetDayTags",props:{data:{},hideApproved:{type:Boolean,default:!1},workingTimeModel:{}},setup(h){const u=h,{t}=Ee(),{declinedAtMessage:B,approvedAtMessage:v,submittedAtMessage:g}=ya(p(()=>u.data.timeSheetDay)),{getPauseErrorMessage:y,getDurationErrorMessage:k}=ps();return(o,_)=>{const I=Ot;return l(),W(pe,null,[o.data.timeSheetDay.declinedAt?(l(),w(re,{key:0,content:e(B)},{default:n(()=>[r(I,{type:"danger"},{default:n(()=>[$(f(e(t)("timeSheets.declined")),1)]),_:1})]),_:1},8,["content"])):S("",!0),!o.hideApproved&&o.data.timeSheetDay.approvedAt&&!o.data.timeSheetDay.declinedAt?(l(),w(re,{key:1,content:e(v)},{default:n(()=>[r(I,{type:"success"},{default:n(()=>[$(f(e(t)("timeSheets.approved")),1)]),_:1})]),_:1},8,["content"])):S("",!0),o.data.timeSheetDay.submittedAt&&!o.data.timeSheetDay.declinedAt&&!o.data.timeSheetDay.approvedAt?(l(),w(re,{key:2,content:e(g)},{default:n(()=>[r(I,{type:"info"},{default:n(()=>[$(f(e(t)("timeSheets.submitted")),1)]),_:1})]),_:1},8,["content"])):S("",!0),!o.data.timeSheetDay.submittedAt&&!o.data.timeSheetDay.approvedAt&&!o.data.timeSheetDay.declinedAt&&o.data.isTodayOrBefore?(l(),w(I,{key:3,type:"warning"},{default:n(()=>[$(f(e(t)("timeSheets.notSubmittedYet")),1)]),_:1})):S("",!0),o.data.durationError?(l(),w(re,{key:4,content:e(k)(o.data.durationError)},{default:n(()=>[r(I,{type:"danger"},{default:n(()=>[$(f(o.data.durationError.type==="durationTooLong"?e(t)("timeSheets.errors.durationTooLong"):""),1)]),_:1})]),_:1},8,["content"])):S("",!0),o.data.pauseError?(l(),w(re,{key:5,content:e(y)(o.data.pauseError)},{default:n(()=>[r(I,{type:"danger"},{default:n(()=>[$(f(o.data.pauseError.type==="pauseTooLong"?e(t)("timeSheets.errors.breakTimeTooLong"):o.data.pauseError.type==="pauseTooShort"?e(t)("timeSheets.errors.breakTimeTooShort"):""),1)]),_:1})]),_:1},8,["content"])):S("",!0),o.data.hasMultipleDays?(l(),w(re,{key:6,content:e(t)("timeSheets.errors.multipleDays")},{default:n(()=>[r(I,{type:"warning"},{default:n(()=>[$(f(e(t)("timeSheets.errors.multipleDaysShort")),1)]),_:1})]),_:1},8,["content"])):S("",!0),o.workingTimeModel?.showIsManipulated&&(o.data.timeSheetDay.manipulatedAt||o.data.lastManipulatedPeriod)?(l(),w(re,{key:7,content:o.data.manipulatedByUser?e(t)("timeSheets.manipulated.infoTextBy",{user:o.data.manipulatedByUser.shortName||o.data.manipulatedByUser.fullName}):e(t)("timeSheets.manipulated.infoText")},{default:n(()=>[r(I,{type:"warning"},{default:n(()=>[$(f(e(t)("timeSheets.manipulated.partly")),1)]),_:1})]),_:1},8,["content"])):S("",!0),(l(!0),W(pe,null,Ke(o.data.holidays,V=>(l(),w(I,{key:V.uuid,type:"warning"},{default:n(()=>[$(f(V.name),1)]),_:2},1024))),128)),(l(!0),W(pe,null,Ke(o.data.userAbsences,V=>(l(),w(I,{key:V.uuid,color:V.type?.color,theme:"plain",style:$n({"--el-tag-text-color":e(sn)(V)})},{default:n(()=>[$(f(V.type?.name??""),1)]),_:2},1032,["color","style"]))),128))],64)}}}),Ks={class:"sm:flex gap-x-1 text-center font-bold"},Xs={class:"flex-none"},Zs={class:"flex-none"},Js={class:"border-[var(--el-border-color-lighter)] border-b w-0 flex-1 flex flex-wrap gap-1 [&:has(span)]:px-2 [&:has(span)]:pb-2"},eo=Xe({__name:"TimeSheetMonth",props:{month:{},user:{},dayData:{},targetSum:{},actions:{},workingTimeModel:{},isPendingCalculatedTargetWorkingTime:{type:Boolean,default:!1}},emits:["submitAll","approveAll","declineAll","unsubmitAll","submit","approve","decline","go-to-date"],setup(h,{emit:u}){const t=h,B=u,{t:v}=Ee(),g=it(),y=p(()=>t.dayData.map(E=>E.timeSheetDay)),k=yt(oa,{interval:{hours:1}}),o=Kn().createScope(),{data:_,isPending:I}=o.useFind({params:p(()=>t.user?{query:{userId:t.user.id,month:{$in:[ke(za(t.month,-1)),ke(t.month)]}}}:null)}),V=p(()=>_.value.find(E=>E.id&&E.month===ke(t.month)&&E.userId===t.user?.id)),j=p(()=>_.value.find(E=>E.id&&E.month===ke(za(t.month,-1))&&E.userId===t.user?.id)),R=p(()=>I.value===!1&&!V.value&&!!t.user);En(R,async()=>{t.user&&o.construct({month:ke(t.month),user:t.user,companyId:t.user.companyId,sumTarget:t.workingTimeModel?t.targetSum??0:null,sumActual:t.workingTimeModel?J.value??0:null,carryOverAfter:t.workingTimeModel?we.value??0:null,carryOverBefore:t.workingTimeModel?O.value??0:null})});const c=p(()=>_.value.find(E=>E.month&&E.month===ke(t.month)&&E.userId===t.user?.id)),J=p(()=>{let E=0;for(const Q of y.value)E+=Q.duration??0;return E}),te=p(()=>{if(!t.dayData.length||!t.workingTimeModel||!vs(k.value,{start:t.dayData.at(0).date,end:t.dayData.at(-1).date}))return;let E=0;for(const{timeSheetDay:Q,key:We,date:Te,userAbsences:xe,holidays:Le,isTodayOrBefore:A,workingTimeModelWeekday:Y}of t.dayData){if(Q.duration){E+=Q.duration;continue}if(A){E+=Q.duration??0;continue}if(Q.manipulatedAt){E+=Q.duration??0;continue}if(Q.submittedAt){E+=Q.duration??0;continue}if(!(Le.length&&!t.workingTimeModel.countHolidaysAsWorkdays)&&!(xe.length&&xe.some(P=>P.type?.countAsWorkingTime===!1))&&Y&&Y?.duration!=null){E+=Y.duration;continue}}return E}),O=p(()=>t.workingTimeModel&&!I.value?j.value?.carryOverAfter??0:void 0),G=p(()=>t.targetSum??void 0),we=p(()=>!t.workingTimeModel||J.value===void 0||c.value?.carryOverBefore===void 0||G.value===void 0?void 0:-((G.value??0)-((J.value??0)+(c.value.carryOverBefore??0)))),N=ta(["admin","superadmin"]),X=p(()=>!!c.value&&!c.value.submittedAt),De=p(()=>!!c.value&&(X.value||N.value&&!c.value.approvedAt)),ie=p(()=>t.user&&c.value&&J.value!==void 0&&c.value.sumActual!==J.value&&X.value?J.value:void 0);$e(ie,E=>{E===void 0||!c.value||c.value.sumActual===E||(c.value.sumActual=E)},{immediate:!0});const L=p(()=>t.user&&c.value&&G.value!==void 0&&c.value.sumTarget!==G.value?G.value:void 0);$e([L,X],([E,Q])=>{!Q||E===void 0||!c.value||c.value.sumTarget===E||(c.value.sumTarget=E)},{immediate:!0});const Ie=p(()=>t.user&&c.value&&O.value!==void 0&&c.value.carryOverBefore!==O.value?O.value:void 0);$e([Ie,X,()=>!!c.value?.carryOverBeforeManipulatedAt],([E,Q,We])=>{!Q||E===void 0||We||!c.value||c.value.carryOverBefore===E||(c.value.carryOverBefore=E)},{immediate:!0});const se=p(()=>{if(!t.user||!c.value||we.value===void 0)return;const E=we.value,Q=t.workingTimeModel?.carryOverMonthMaximum||Number.MAX_SAFE_INTEGER;return c.value.carryOverAfter!==Math.min(E,Q)?Math.min(E,Q):void 0});$e([se,X],([E,Q])=>{!Q||E===void 0||!c.value||c.value.carryOverAfter===E||(c.value.carryOverAfter=E)},{immediate:!0});const ye=p(()=>!!c.value&&De.value&&(ie.value!==void 0||L.value!==void 0||Ie.value!==void 0||se.value!==void 0));function Be(){!ye.value||!c.value||(ie.value!==void 0&&(c.value.sumActual=ie.value),L.value!==void 0&&(c.value.sumTarget=L.value),Ie.value!==void 0&&(c.value.carryOverBefore=Ie.value,c.value.carryOverBeforeManipulatedAt=null),se.value!==void 0&&(c.value.carryOverAfter=se.value))}const Oe=p(()=>c.value?!c.value.id||o.hasChanges(c.value):!1);In(Oe,()=>{!c.value||!Oe.value||o.save(c.value)},{debounce:350});function q(){c.value&&(c.value.declinedAt=null,c.value.declinedById=null,c.value.declinedNote=null)}function fe(){B("approveAll"),!(!c.value||c.value.approvedAt)&&(c.value.approvedAt=new Date,c.value.approvedBy=g.value,c.value.declinedAt=null,c.value.declinedById=null,c.value.declinedNote=null)}function Re(){B("unsubmitAll"),!(!c.value||!c.value.submittedAt||c.value.approvedAt)&&(c.value.submittedAt=null,q())}const{actionsForDay:ue}=an(),ge=p(()=>t.dayData.map((E,Q)=>ue(E,B)));return(E,Q)=>{const We=ut("font-awesome-icon"),Te=mt,xe=da,Le=ra,A=ia,Y=la;return l(),W("div",null,[e(c)?Ut((l(),w(Ys,{key:0,"time-sheet-month":e(c),"calculated-carry-over-after":e(we),"calculated-carry-over-before":e(O),"calculated-sum-actual":e(J),"calculated-sum-target":e(G),"calculated-sum-actual-and-planned":e(te),actions:E.actions,"day-data":E.dayData,"can-edit":e(De),"can-reset":e(ye),"working-time-model":E.workingTimeModel,class:"mb-2",onReset:Be,onSubmitAll:Q[0]||(Q[0]=()=>B("submitAll",{timeSheetMonth:e(c)})),onApproveAll:fe,onDeclineAll:Q[1]||(Q[1]=()=>B("declineAll",{timeSheetMonth:e(c)})),onUnsubmitAll:Re},null,8,["time-sheet-month","calculated-carry-over-after","calculated-carry-over-before","calculated-sum-actual","calculated-sum-target","calculated-sum-actual-and-planned","actions","day-data","can-edit","can-reset","working-time-model"])),[[Y,E.isPendingCalculatedTargetWorkingTime]]):S("",!0),r(on,{data:E.dayData,"row-class":P=>P.timeSheetDay.approvedAt?"bg-green-100/60":P.timeSheetDay.declinedAt?"bg-red-100/70":P.isToday?"bg-yellow-50":P.numberOfWeek===0||P.numberOfWeek===6||P.holidays.length||P.userAbsences.length?"bg-[var(--el-fill-color-lighter)]":void 0,class:"[&>tr>th]:!px-1 [&>tr>th]:md:!px-2 [&>tr>td]:!px-1 [&>tr>td]:md:!px-2 [&>tr>td]:!border-b-0 shadow"},{default:n(()=>[r(_e,{title:"Tag","header-class":"!text-center",class:"justify-center",width:"minmax(30px, max-content)"},{default:n(({row:P})=>[T("div",Ks,[T("div",Xs,f(e(Ha)(P.date,"EEEEEE")),1),T("div",Zs,f(e(Ha)(P.date,"dd.")),1)])]),_:1}),r(_e,{title:"Beginn","header-class":"!text-center",class:"justify-center",width:"max-content"},{default:n(({row:P})=>[P.hasAbsenceOrHoliday?S("",!0):(l(),w(Qe,{key:0,"model-value":P.timeSheetDay.startsAt,"value-type":"date","ref-date":P.date,placeholder:P.editable?e(v)("timeSheets.form.startTime"):"-",before:P.timeSheetDay?.endsAt??void 0,class:Se({"inline-edit [&_input]:!cursor-default":!P.editable}),disabled:!P.editable,"onUpdate:modelValue":s=>P.manipulateByHand("startsAt",s)},null,8,["model-value","ref-date","placeholder","before","class","disabled","onUpdate:modelValue"]))]),_:1}),r(_e,{title:"Ende","header-class":"!text-center",class:"justify-center",width:"max-content"},{default:n(({row:P})=>[P.hasAbsenceOrHoliday?S("",!0):(l(),w(Qe,{key:0,"model-value":P.endsAt,"value-type":"date","ref-date":P.date,after:P.timeSheetDay?.startsAt??void 0,placeholder:P.editable?e(v)("timeSheets.form.endTime"):"-",class:Se({"inline-edit [&_input]:!cursor-default":!P.editable}),disabled:!P.editable,"onUpdate:modelValue":s=>P.manipulateByHand("endsAt",s)},null,8,["model-value","ref-date","after","placeholder","class","disabled","onUpdate:modelValue"]))]),_:1}),r(_e,{title:"Pause","header-class":"!text-center",class:"justify-center",width:"max-content"},{default:n(({row:P})=>[P.hasAbsenceOrHoliday?S("",!0):(l(),w(Qe,{key:0,"model-value":P.pauseDuration,"value-type":"number",placeholder:P.editable?e(v)("timeSheets.form.pause"):"-","typing-minutes":"",class:Se({"inline-edit [&_input]:!cursor-default":!P.editable}),disabled:!P.editable,"onUpdate:modelValue":s=>P.manipulateByHand("pauseDuration",s)},null,8,["model-value","placeholder","class","disabled","onUpdate:modelValue"]))]),_:1}),r(_e,{title:"Dauer","header-class":"!text-center",class:"justify-center",width:"max-content"},{default:n(({row:P})=>[r(Qe,{"model-value":P.duration,"value-type":"number",placeholder:P.editable?"00:00":"-",class:Se({"inline-edit !cursor-default [&_input]:!cursor-default":!P.editable||!P.hasAbsenceOrHoliday}),disabled:!P.editable||!P.hasAbsenceOrHoliday,"onUpdate:modelValue":s=>P.manipulateByHand("duration",s)},null,8,["model-value","placeholder","class","disabled","onUpdate:modelValue"])]),_:1}),r(_e,{width:"max-content"},{default:n(({index:P})=>[e(ge)[P].length?(l(),w(A,{key:0},{dropdown:n(()=>[r(Le,null,{default:n(()=>[(l(!0),W(pe,null,Ke(e(ge)[P],({label:s,action:d,fontAwesomeIcon:z,ElIcon:K})=>(l(),w(xe,{key:s,icon:K,onClick:d},{default:n(()=>[z?(l(),w(We,{key:0,icon:z,"fixed-width":"",class:"text-xs mr-1.5"},null,8,["icon"])):S("",!0),$(" "+f(s),1)]),_:2},1032,["icon","onClick"]))),128))]),_:2},1024)]),default:n(()=>[r(Te,{text:""},{default:n(()=>[r(We,{icon:"ellipsis-v"})]),_:1})]),_:2},1024)):S("",!0)]),_:1}),r(_e,{"full-row":"",class:"!p-0 !border-b-0"},{"full-row":n(({row:P})=>[T("div",Js,[r(Et,{data:P,"working-time-model":E.workingTimeModel,"hide-approved":""},null,8,["data","working-time-model"])])]),_:1})]),_:1},8,["data","row-class"])])}}}),to={key:0},ao={class:"text-danger text-xs ml-1"},no={key:1},so={class:"text-gray-500 text-xs ml-1"},oo={class:"gap-1 flex flex-col"},un=Xe({__name:"TimeSheetDayHintAlerts",props:{data:{},errors:{},warnings:{}},setup(h){const u=h,{t}=Ee(),{declinedMessage:B}=ya(p(()=>u.data.timeSheetDay));return(v,g)=>{const y=Qa;return l(),W("div",null,[v.data.timeSheetDay.declinedNote?(l(),W("div",to,[T("p",ao,f(e(B))+":",1),r(y,{closable:!1,type:"error","show-icon":""},{title:n(()=>[$(f(v.data.timeSheetDay.declinedNote),1)]),_:1})])):S("",!0),v.errors.length>0||v.warnings.length>0?(l(),W("div",no,[T("p",so,f(e(t)("timeSheets.hints"))+":",1),T("div",oo,[(l(!0),W(pe,null,Ke(v.errors,k=>(l(),w(y,{key:k,title:k,closable:!1,type:"warning","show-icon":""},null,8,["title"]))),128)),(l(!0),W(pe,null,Ke(v.warnings,k=>(l(),w(y,{key:k,title:k,closable:!1,type:"info","show-icon":""},null,8,["title"]))),128))])])):S("",!0)])}}}),ro={class:"flex flex-1 gap-1"},io={key:0,class:"text-gray-400 text-xs flex py-1"},lo={class:"flex-1 w-0 text-center leading-none"},uo={key:0,class:"text-gray-400 text-xs flex py-1"},mo={class:"flex-1 w-0 text-center leading-none"},co={class:"flex-1"},po={key:0,class:"text-gray-600 text-xs text-center pt-1"},fo={key:1,class:"text-gray-400 text-xs flex py-1"},vo={class:"flex-1 w-0 text-center leading-none"},yo={key:0,class:"text-gray-600 text-xs text-center pt-1"},mn=Xe({__name:"TimeSheetDayTimeInputs",props:{data:{}},setup(h){const{t:u}=Ee();return(t,B)=>(l(),W(pe,null,[t.data.showStartsAtEndsAt?(l(),w(Ne,{key:0,title:e(u)("timeSheets.presenceTime")},{default:n(()=>[T("div",ro,[T("div",null,[r(Qe,{"model-value":t.data.startsAt,"value-type":"date","ref-date":t.data.date,before:t.data.endsAt??void 0,placeholder:t.data.editable?e(u)("timeSheets.form.startTime"):"-",class:Se({"inline-edit [&_input]:!cursor-default":!t.data.editable}),disabled:!t.data.editable,"onUpdate:modelValue":B[0]||(B[0]=v=>t.data.manipulateByHand("startsAt",v??null))},null,8,["model-value","ref-date","before","placeholder","class","disabled"]),t.data.corrected.startsAtCorrectedTypeLabel?(l(),W("div",io,[T("div",lo,f(t.data.corrected.startsAtCorrectedTypeLabel),1)])):S("",!0)]),T("div",null,[r(Qe,{"model-value":t.data.endsAt,"value-type":"date","ref-date":t.data.date,after:t.data.startsAt??void 0,placeholder:t.data.editable?e(u)("timeSheets.form.endTime"):"-",class:Se({"inline-edit [&_input]:!cursor-default":!t.data.editable}),disabled:!t.data.editable,"onUpdate:modelValue":B[1]||(B[1]=v=>t.data.manipulateByHand("endsAt",v??null))},null,8,["model-value","ref-date","after","placeholder","class","disabled"]),t.data.corrected.endsAtCorrectedTypeLabel?(l(),W("div",uo,[T("div",mo,f(t.data.corrected.endsAtCorrectedTypeLabel),1)])):S("",!0)])])]),_:1},8,["title"])):S("",!0),t.data.showStartsAtEndsAt?(l(),w(Ne,{key:1,title:e(u)("timeSheets.breakTime"),"has-error":!!t.data.pauseError},{default:n(()=>[T("div",co,[r(Qe,{"model-value":t.data.pauseDuration,"value-type":"number",style:{width:"70px"},placeholder:t.data.editable?"00:00":"-","typing-minutes":"",class:Se({"inline-edit [&_input]:!cursor-default":!t.data.editable}),disabled:!t.data.editable,"onUpdate:modelValue":B[2]||(B[2]=v=>t.data.manipulateByHand("pauseDuration",v??null))},null,8,["model-value","placeholder","class","disabled"]),t.data.pauseError?(l(),W("div",po,f(t.data.pauseError.type==="pauseTooShort"?e(u)("timeSheets.errors.breakTimeExpectedMin",{time:e(Ce)(t.data.pauseError.expected)}):t.data.pauseError.type==="pauseTooLong"?e(u)("timeSheets.errors.breakTimeExpectedMax",{time:e(Ce)(t.data.pauseError.expected)}):""),1)):t.data.corrected.pauseDurationCorrectedTypeLabel?(l(),W("div",fo,[T("div",vo,f(t.data.corrected.pauseDurationCorrectedTypeLabel),1)])):S("",!0)])]),_:1},8,["title","has-error"])):S("",!0),r(Ne,{title:t.data.showStartsAtEndsAt?e(u)("timeSheets.workTime"):e(u)("timeSheets.absenceTime"),"has-error":!!t.data.durationError},{default:n(()=>[r(Qe,{"model-value":t.data.duration,"value-type":"number",placeholder:t.data.editable?"00:00":"",class:Se([{"inline-edit [&_input]:!cursor-default":!t.data.editable||t.data.showStartsAtEndsAt},"flex-1"]),disabled:!t.data.editable||t.data.showStartsAtEndsAt,"onUpdate:modelValue":B[3]||(B[3]=v=>t.data.manipulateByHand("duration",v??null))},null,8,["model-value","placeholder","class","disabled"]),t.data.durationError?(l(),W("div",yo,f(t.data.durationError.type==="durationTooLong"?e(u)("timeSheets.errors.durationExpectedMax",{time:e(Ce)(t.data.durationError.expected)}):""),1)):S("",!0)]),_:1},8,["title","has-error"])],64))}}),ho={class:"md:flex md:flex-row"},go={class:"sticky top-0 text-center p-2"},Ao={class:"text-sm font-bold leading-tight"},bo={class:"text-base leading-tight pb-2"},ko={class:"flex flex-initial flex-wrap justify-center gap-1 [&:has(span)]:mb-2"},So={class:"!mb-0 pr-3 font-bold text-base"},wo={class:"w-0 inline-flex gap-1 flex-1 overflow-hidden"},Do={class:"flex flex-col gap-2 flex-grow pt-2 md:pb-2"},To={class:"flex gap-2 flex-wrap mx-2"},_o={class:"flex flex-grow flex-row flex-wrap gap-1"},Mo={class:"flex flex-wrap gap-1"},Bo={class:"hidden md:flex flex-grow justify-end"},Po={key:0,class:"mx-2"},Co={class:"text-gray-500 text-xs ml-1"},$o={class:"flex flex-grow w-full"},Eo={key:1,class:"bg-white border-gray-200 border mx-0 md:mx-2"},Io={class:"flex-1 flex items-center p-0.5 pl-3 text-base"},Oo={class:"ml-2 gap-1 hidden sm:flex"},Wo={class:"flex sm:hidden gap-1 p-3"},xo={key:0,class:"p-2 text-gray-400 text-center text-xs"},Uo={class:"flex"},No={class:"flex-1 text-sm"},Fo={class:"mr-0.5 text-gray-400"},Vo={key:0},Ho={key:0,class:"flex text-sm"},Ro={class:"mr-1 text-gray-400"},Lo=Ka(()=>en(()=>import("./AssignmentEventWorkPeriodForm-Dx6x-Hqu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]))),qo=Ka(()=>en(()=>import("./UnaccountablePeriodForm-BLLNWtML.js"),__vite__mapDeps([26,27,4,2,3,5,6,7,8,9,10,11,12,13,14,15,16,28,23,24,25]))),jo=Xe({__name:"TimeSheetDayForWeek",props:{day:{},user:{},data:{},workingTimeModel:{},showIsManipulated:{type:Boolean,default:!1}},emits:["submit","approve","decline","go-to-date"],setup(h,{emit:u}){const[t,B]=Ea(),[v,g]=Ea(),y=h,k=u,{t:o}=Ee(),_=it(),I=Za(),V=On({interval:1e3*60*5}),j=ce(!1),R=ce(!(I.md&&y.data.combinedWorkPeriods.length===0)&&y.data.combinedWorkPeriods.length<=5),c=ca().createScope(),J=pa().createScope(),te=it(),{getAssignmentNameToShow:O}=Ja(),G=p(()=>te.value?.role?.type!=="admin"&&te.value?.role?.type!=="superadmin"&&y.user.supervisorUuid===te.value?.uuid),we=ce();Ya(rn,{formRef:we});const N=ce(null);function X(A){if(A===!1){N.value=null;return}A!==!0&&(N.value=A)}const De=p(()=>N.value&&Me(N.value,"assignment-event-work-periods")?"AssignmentEventWorkPeriod":"UnaccountablePeriod");function ie(A){N.value=A}function L(A){A==="AssignmentEventWorkPeriod"?N.value=c.construct({companyId:y.user.companyId,userId:y.user.id,start:y.day,manipulatedAt:new Date,manipulatedBy:_.value}):N.value=J.construct({companyId:y.user.companyId,userId:y.user.id,start:y.day,manipulatedAt:new Date,manipulatedBy:_.value}),R.value=!0}const{validateAsync:Ie}=dn(we),{execute:se}=ea(async()=>{try{if(!N.value)return;await Ie(),N.value.manipulatedAt=new Date,N.value.manipulatedBy=te.value,Me(N.value,"assignment-event-work-periods")?await c.save(N.value):await J.save(N.value),N.value=null}catch{return}},{useNProgress:!0});function ye(){N.value&&(Me(N.value,"assignment-event-work-periods")?c.resetOrRemove(N.value):J.resetOrRemove(N.value)),N.value=null}async function Be(A){Me(A,"assignment-event-work-periods")?await c.remove(A):await J.remove(A)}function Oe(A){return ze(A,"eee")}function q(A){return ze(A,"dd.MM.")}function fe(A){return gt(A.start,A.end??V.value)?"primary":"warning"}function Re(A){return A.start?`${Ye(A.start,{dateToCompare:y.day,shortToday:!0})} - ${A.end?Ye(A.end,{dateToCompare:y.day,shortToday:!0}):o("timeSheets.table.ongoing")}`:""}const{errors:ue,warnings:ge}=nn(p(()=>y.data)),E=p(()=>G.value&&!y.data.timeSheetDay.note),Q=ln().useHasItems("unaccountable-period-types"),We=p(()=>y.data.showStartsAtEndsAt||y.data.combinedWorkPeriods.length>0),{getApprovedMessage:Te}=va(),{actionsForDay:xe}=an(),Le=p(()=>xe(y.data,k));return(A,Y)=>{const P=It,s=mt,d=ut("font-awesome-icon"),z=da,K=ra,ae=ia,Ae=ua,qe=Ot,Ue=Un,Z=Nn,et=Fn,bt=Vn,kt=ma;return l(),W("div",ho,[r(e(t),null,{default:n(({class:F})=>[T("div",{class:Se([F,"flex gap-1"])},[e(I).md?(l(),W(pe,{key:0},[A.data.canSubmit?(l(),w(re,{key:0,content:e(o)("timeSheets.Submit")},{default:n(()=>[r(s,{type:"primary",plain:A.data.canApprove,onClick:Y[0]||(Y[0]=()=>k("submit",A.data.timeSheetDay))},{default:n(()=>[r(P,null,{default:n(()=>[r(e(At))]),_:1})]),_:1},8,["plain"])]),_:1},8,["content"])):S("",!0),A.data.canApprove?(l(),w(re,{key:1,content:A.data.timeSheetDay.approvedAt?e(Te)(A.data.timeSheetDay):e(o)("timeSheets.Approve")},{default:n(()=>[r(s,{type:"primary",disabled:!!A.data.timeSheetDay.approvedAt,onClick:Y[1]||(Y[1]=()=>k("approve",A.data.timeSheetDay))},{default:n(()=>[r(P,null,{default:n(()=>[r(e(Wt))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["content"])):S("",!0),A.data.canDecline?(l(),w(re,{key:2,content:e(o)("actions.Decline")},{default:n(()=>[r(s,{type:"danger",disabled:!!A.data.timeSheetDay.declinedAt,plain:!A.data.timeSheetDay.declinedAt&&(!!A.data.timeSheetDay.approvedAt||!!A.data.timeSheetDay.declinedAt),onClick:Y[2]||(Y[2]=()=>k("decline",A.data.timeSheetDay))},{default:n(()=>[r(P,null,{default:n(()=>[r(e(xt))]),_:1})]),_:1},8,["disabled","plain"])]),_:1},8,["content"])):S("",!0),r(re,{content:"Gehe zu Tag"},{default:n(()=>[r(s,{onClick:Y[3]||(Y[3]=Fe=>k("go-to-date",A.data.date))},{default:n(()=>[r(P,null,{default:n(()=>[r(d,{icon:"external-link-alt",class:"text-xs"})]),_:1})]),_:1})]),_:1})],64)):(l(),w(ae,{key:1},{dropdown:n(()=>[r(K,null,{default:n(()=>[(l(!0),W(pe,null,Ke(e(Le),({label:Fe,action:St,fontAwesomeIcon:wt,ElIcon:Nt})=>(l(),w(z,{key:Fe,icon:Nt,onClick:St},{default:n(()=>[wt?(l(),w(d,{key:0,icon:wt,"fixed-width":"",class:"text-xs mr-1.5"},null,8,["icon"])):S("",!0),$(" "+f(Fe),1)]),_:2},1032,["icon","onClick"]))),128))]),_:1})]),default:n(()=>[r(s,{text:""},{default:n(()=>[r(d,{icon:"ellipsis-v"})]),_:1})]),_:1}))],2)]),_:1}),r(e(v),null,{default:n(()=>[r(s,{type:"primary",onClick:Y[4]||(Y[4]=Zt(()=>L("AssignmentEventWorkPeriod"),["stop"]))},{default:n(()=>[$(f(e(o)("timeSheets.AssignmentEventWorkPeriodShort"))+" ",1),r(d,{icon:"plus",class:"ml-2 text-xs"})]),_:1}),e(Q)?(l(),w(s,{key:0,type:"primary",onClick:Y[5]||(Y[5]=Zt(()=>L("UnaccountablePeriod"),["stop"]))},{default:n(()=>[$(f(e(o)("timeSheets.UnaccountablePeriodShort"))+" ",1),r(d,{icon:"plus",class:"ml-2 text-xs"})]),_:1})):S("",!0)]),_:1}),T("div",{class:Se(["w-28 flex-none text-center hidden md:block relative overflow-hidden border-r-gray-200 border-r",[A.data.timeSheetDay.approvedAt&&!e(ue).length&&!e(ge).length?"bg-success/10":A.data.timeSheetDay.declinedAt||e(ue).length>0?"bg-danger/10 border-l-4 border-danger":!A.data.timeSheetDay.declinedAt&&!e(ue).length&&e(ge).length>0?"bg-warning/10 border-l-4 border-warning":e(Jt)(A.day)?"bg-yellow-50":"bg-white"]])},[T("div",go,[T("p",Ao,f(Oe(A.day)),1),T("p",bo,f(q(A.day)),1),T("div",ko,[r(Et,{data:A.data,"working-time-model":A.workingTimeModel},null,8,["data","working-time-model"])])])],2),T("div",{class:Se(["md:hidden flex flex-grow justify-between items-center p-2",[A.data.timeSheetDay.approvedAt&&!e(ue).length&&!e(ge).length?"bg-success/10":A.data.timeSheetDay.declinedAt||e(ue).length>0?"bg-danger/10 border-l-4 border-danger":!A.data.timeSheetDay.declinedAt&&!e(ue).length&&e(ge).length>0?"bg-warning/10 border-l-4 border-warning":e(Jt)(A.day)?"bg-yellow-50":"bg-white"]])},[T("div",So,f(Oe(A.day))+" "+f(q(A.day)),1),T("div",wo,[r(Et,{data:A.data,"working-time-model":A.workingTimeModel},null,8,["data","working-time-model"])]),r(e(B),{class:"ml-1"})],2),T("div",Do,[T("div",To,[T("div",_o,[T("div",Mo,[r(mn,{data:A.data},null,8,["data"]),A.data.canRecompute?(l(),w(re,{key:0,content:e(o)("actions.Refresh")},{default:n(()=>[r(s,{type:"primary",onClick:A.data.recompute},{default:n(()=>[r(P,null,{default:n(()=>[r(e(sa))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["content"])):S("",!0),!e(j)&&!A.data.timeSheetDay.note?(l(),w(re,{key:1,content:e(o)("timeSheets.addNote")},{default:n(()=>[r(s,{onClick:Y[6]||(Y[6]=F=>j.value=!0)},{default:n(()=>[r(d,{icon:["far","comment"]})]),_:1})]),_:1},8,["content"])):S("",!0)]),T("div",Bo,[r(e(B))])])]),!e(E)&&(e(j)||A.data.timeSheetDay.note)?(l(),W("div",Po,[T("p",Co,f(e(o)("timeSheets.note"))+":",1),T("div",$o,[r(Ae,{modelValue:A.data.timeSheetDay.note,"onUpdate:modelValue":Y[7]||(Y[7]=F=>A.data.timeSheetDay.note=F),disabled:!A.data.canSubmit,rows:e(I).maxXs?3:e(I).maxMd?2:1,type:"textarea",placeholder:e(o)("timeSheets.note")},null,8,["modelValue","disabled","rows","placeholder"])])])):S("",!0),r(un,{data:A.data,errors:e(ue),warnings:e(ge),class:"mx-2"},null,8,["data","errors","warnings"]),e(We)?(l(),W("div",Eo,[T("div",{class:Se(["flex border-gray-100 bg-gray-100",{"border-b":e(R)}])},[T("div",Io,[T("div",{class:"flex flex-1 cursor-pointer text-gray-500 items-center",onClick:Y[8]||(Y[8]=F=>R.value=!e(R))},[$(f(e(o)("timeSheets.Periods"))+" ("+f(A.data.combinedWorkPeriods.length)+") ",1),T("div",Oo,[r(e(g))])])]),r(s,{text:"",size:"large",onClick:Y[9]||(Y[9]=F=>R.value=!e(R))},{default:n(()=>[r(d,{icon:"angle-down",class:"ml-1 transition-all",rotation:e(R)?"180":void 0},null,8,["rotation"])]),_:1})],2),Ut(T("div",null,[T("div",Wo,[r(e(g))]),(l(),w(xn,null,[A.data.combinedWorkPeriods.length?(l(),W(pe,{key:1},[e(I).lg?(l(),w(on,{key:0,data:A.data.combinedWorkPeriods},{default:n(()=>[r(_e,{title:e(o)("timeSheets.table.fromTo")},{default:n(({row:F})=>[$(f(Re(F)),1)]),_:1},8,["title"]),r(_e,{title:e(o)("timeSheets.table.assignment")},{default:n(({row:F})=>[$(f(e(O)(F.assignment)),1)]),_:1},8,["title"]),r(_e,{title:e(o)("timeSheets.table.step")},{default:n(({row:F})=>[$(f("event"in F?F.event?.type?.name:F.eventType?.name),1)]),_:1},8,["title"]),r(_e,{title:e(o)("timeSheets.table.workType")},{default:n(({row:F})=>[$(f(F.type?.name),1)]),_:1},8,["title"]),r(_e,{title:e(o)("Note")},{default:n(({row:F})=>[$(f(F.note),1)]),_:1},8,["title"]),A.showIsManipulated?(l(),w(_e,{key:0,width:"max-content"},{default:n(({row:F})=>[r(re,{content:F.manipulatedBy?e(o)("timeSheets.manipulated.infoTextBy",{user:F.manipulatedBy.shortName||F.manipulatedBy.fullName}):e(o)("timeSheets.manipulated.infoText")},{default:n(()=>[F.manipulatedAt?(l(),w(qe,{key:0,type:"warning"},{default:n(()=>[$(f(e(o)("timeSheets.manipulated.partly")),1)]),_:1})):S("",!0)]),_:2},1032,["content"])]),_:1})):S("",!0),r(_e,{width:"max-content"},{default:n(({row:F})=>[r(Z,null,{default:n(()=>[r(s,{class:"mr-2",onClick:Fe=>ie(F)},{default:n(()=>[r(P,null,{default:n(()=>[r(e(Ia))]),_:1})]),_:2},1032,["onClick"]),r(Ue,{"confirm-button-text":e(o)("actions.Delete"),"cancel-button-text":e(o)("actions.Cancel"),icon:e(Oa),"icon-color":"#626AEF",title:e(o)("confirm.delete"),width:"260px",onConfirm:Fe=>Be(F)},{reference:n(()=>[r(s,{type:"danger",plain:""},{default:n(()=>[r(P,null,{default:n(()=>[r(e(Wa))]),_:1})]),_:1})]),_:2},1032,["confirm-button-text","cancel-button-text","icon","title","onConfirm"])]),_:2},1024)]),_:1})]),_:1},8,["data"])):(l(),w(bt,{key:1,class:"p-4 pt-2 pr-2"},{default:n(()=>[(l(!0),W(pe,null,Ke(A.data.combinedWorkPeriods,F=>(l(),w(et,{key:F.uuid,timestamp:Re(F),placement:"top",hollow:e(Me)(F,"unaccountable-periods")&&!!F,type:fe(F)},{default:n(()=>[T("div",Uo,[T("div",No,[e(Me)(F,"assignment-event-work-periods")&&F?(l(),W(pe,{key:0},[T("div",null,[T("span",Fo,f(e(o)("assignment.name"))+":",1),$(" "+f(e(O)(F.assignment)),1)]),T("div",null,f(F.eventType?.name),1),F.type?.name?(l(),W("div",Vo,f(F.type?.name),1)):S("",!0)],64)):S("",!0),e(Me)(F,"unaccountable-periods")&&F?(l(),W(pe,{key:1},[T("div",null,f(F.type?.name),1),T("div",null,f(F.eventType?.name),1)],64)):S("",!0)]),r(Z,{class:"-mt-6"},{default:n(()=>[r(s,{onClick:Fe=>ie(F)},{default:n(()=>[r(P,null,{default:n(()=>[r(e(Ia))]),_:1})]),_:2},1032,["onClick"]),r(Ue,{"confirm-button-text":e(o)("actions.Delete"),"cancel-button-text":e(o)("actions.Cancel"),icon:e(Oa),"icon-color":"#626AEF",title:e(o)("confirm.delete"),width:"260px",onConfirm:Fe=>Be(F)},{reference:n(()=>[r(s,{type:"danger",plain:""},{default:n(()=>[r(P,null,{default:n(()=>[r(e(Wa))]),_:1})]),_:1})]),_:2},1032,["confirm-button-text","cancel-button-text","icon","title","onConfirm"])]),_:2},1024)]),F.note?(l(),W("div",Ho,[T("span",Ro,f(e(o)("Note"))+":",1),$(" "+f(F.note),1)])):S("",!0)]),_:2},1032,["timestamp","hollow","type"]))),128))]),_:1}))],64)):(l(),W("div",xo,f(e(o)("timeSheets.noWorkPeriods")),1))],1024))],512),[[Wn,e(R)]])])):S("",!0)]),T("div",null,[e(N)?(l(),w(kt,{key:0,"model-value":!!e(N),class:"dialog-messagebox-[500px]","onUpdate:modelValue":X},{header:n(()=>[$(f(e(o)(e(De)==="AssignmentEventWorkPeriod"?"timeSheets.AssignmentEventWorkPeriod":"timeSheets.UnaccountablePeriod")),1)]),footer:n(()=>[r(s,{class:"mr-2",text:"",onClick:ye},{default:n(()=>[$(f(e(o)("actions.Cancel")),1)]),_:1}),r(s,{type:"primary",onClick:e(se)},{default:n(()=>[$(f(e(o)("timeSheets.form.enterPeriod")),1)]),_:1},8,["onClick"])]),default:n(()=>[e(De)==="AssignmentEventWorkPeriod"&&e(N)?(l(),w(e(Lo),{key:0,users:[A.user],item:e(N),"limit-time-to-date":A.day,"allow-assignment-edit":"","hide-user-edit":""},null,8,["users","item","limit-time-to-date"])):e(De)==="UnaccountablePeriod"&&e(N)?(l(),w(e(qo),{key:1,users:[A.user],item:e(N),"limit-time-to-date":A.day,"hide-user-edit":""},null,8,["users","item","limit-time-to-date"])):S("",!0)]),_:1},8,["model-value"])):S("",!0)])])}}}),zo={class:"bg-gray-100 p-2 mb-2 rounded shadow flex flex-col gap-1"},Go={class:"flex flex-wrap gap-2"},Qo={class:"flex-1"},Yo={class:"leading-loose"},Ko={class:"leading-loose"},Xo={class:"leading-loose"},Zo={class:"flex gap-1"},Jo={class:"border border-gray-200"},er=Xe({__name:"TimeSheetWeek",props:{date:{},user:{},dayData:{},targetSum:{},actions:{},isPendingCalculatedTargetWorkingTime:{type:Boolean,default:!1},workingTimeModel:{},showIsManipulated:{type:Boolean,default:!1}},emits:["submitAll","approveAll","declineAll","unsubmitAll","submit","approve","decline","go-to-date"],setup(h,{emit:u}){const t=h,B=u,{t:v}=Ee(),g=p(()=>t.dayData.map(_=>_.timeSheetDay)),y=p(()=>{if(!g.value.length)return 0;let _=0;for(const I of g.value)_+=I.duration??0;return _}),{getDeclinedMessage:k,getApprovedMessage:o}=va();return(_,I)=>{const V=It,j=mt,R=ut("ArtesaTooltip"),c=Ot,J=la;return l(),W("div",null,[Ut((l(),W("div",zo,[T("div",Go,[T("div",Qo,[r(fa,null,{default:n(()=>[r(Ne,{title:_.$t("timeSheets.monthsOverview.sumActual"),class:"w-20"},{default:n(()=>[T("div",Yo,f(e(Ce)(e(y))),1)]),_:1},8,["title"]),_.targetSum!==void 0?(l(),w(Ne,{key:0,title:_.$t("timeSheets.monthsOverview.sumTarget"),class:"w-20"},{default:n(()=>[T("div",Ko,f(e(Ce)(_.targetSum)),1)]),_:1},8,["title"])):S("",!0),_.targetSum!==void 0?(l(),w(Ne,{key:1,title:e(v)("timeSheets.monthsOverview.difference"),class:"w-20"},{default:n(()=>[T("div",Xo,f(e(Ce)(-(_.targetSum-e(y)))),1)]),_:1},8,["title"])):S("",!0)]),_:1})]),T("div",Zo,[r(R,{content:e(v)("timeSheets.submitAll")},{default:n(()=>[_.actions.canSubmit?(l(),w(j,{key:0,type:"primary",class:"allow-cursor",onClick:I[0]||(I[0]=()=>B("submitAll"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(At))]),_:1})]),_:1})):S("",!0)]),_:1},8,["content"]),_.actions.canApprove?(l(),w(R,{key:0,content:e(v)("timeSheets.approveAll")},{default:n(()=>[r(j,{type:"primary",plain:!!_.actions.timeSheetsToSubmit.length,disabled:!_.actions.timeSheetsToApprove.length,class:"allow-cursor",onClick:I[1]||(I[1]=()=>B("approveAll"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(Wt))]),_:1})]),_:1},8,["plain","disabled"])]),_:1},8,["content"])):S("",!0),_.actions.canDecline?(l(),w(R,{key:1,content:e(v)("timeSheets.declineAll")},{default:n(()=>[r(j,{type:"danger",plain:!!_.actions.timeSheetsToSubmit.length||!_.actions.timeSheetsToDecline.length,disabled:!_.actions.timeSheetsToDecline.length,class:"allow-cursor",onClick:I[2]||(I[2]=()=>B("declineAll"))},{default:n(()=>[r(V,null,{default:n(()=>[r(e(xt))]),_:1})]),_:1},8,["plain","disabled"])]),_:1},8,["content"])):S("",!0)])]),T("div",null,[_.dayData.some(te=>!!te.timeSheetDay.declinedAt)?(l(),w(R,{key:0,content:e(k)(_.dayData.find(te=>!!te.timeSheetDay.declinedAt).timeSheetDay)},{default:n(()=>[r(c,{type:"danger"},{default:n(()=>[$(f(e(v)("timeSheets.declined")),1)]),_:1})]),_:1},8,["content"])):_.dayData.every(te=>!!te.timeSheetDay.approvedAt)?(l(),w(R,{key:1,content:e(o)(_.dayData.at(-1).timeSheetDay)},{default:n(()=>[r(c,{type:"success"},{default:n(()=>[$(f(e(v)("timeSheets.approved")),1)]),_:1})]),_:1},8,["content"])):_.dayData.every(te=>!!te.timeSheetDay.submittedAt)?(l(),w(c,{key:2,type:"info"},{default:n(()=>[$(f(e(v)("timeSheets.submitted")),1)]),_:1})):(l(),w(c,{key:3,type:"warning"},{default:n(()=>[$(f(e(v)("timeSheets.notSubmittedYet")),1)]),_:1}))])])),[[J,_.isPendingCalculatedTargetWorkingTime]]),T("div",Jo,[(l(!0),W(pe,null,Ke(_.dayData,(te,O)=>(l(),w(jo,{key:te.key,day:te.date,user:_.user,data:te,"working-time-model":_.workingTimeModel,"show-is-manipulated":_.showIsManipulated,class:Se({"border-b border-gray-200":O<_.dayData.length-1}),onSubmit:I[3]||(I[3]=G=>B("submit",G)),onApprove:I[4]||(I[4]=G=>B("approve",G)),onDecline:I[5]||(I[5]=G=>B("decline",G)),onGoToDate:I[6]||(I[6]=G=>B("go-to-date",G))},null,8,["day","user","data","working-time-model","show-is-manipulated","class"]))),128))])])}}});function tr(h){aa(1,arguments);var u=na(h);return u.setMinutes(59,59,999),u}function ar(h){aa(1,arguments);var u=na(h);return u.setMinutes(0,0,0),u}const nr={class:"flex flex-wrap gap-2"},sr={class:"flex flex-1 gap-1"},or={class:"flex flex-wrap gap-1"},rr={key:0},ir={class:"text-gray-500 text-xs"},lr={class:"flex flex-wrap gap-1"},dr={key:0},ur={class:"text-xs"},mr=T("span",{class:"mx-1"},"-",-1),cr={key:0},pr={key:1,class:"text-xs"},fr={key:0,class:"text-xs"},vr={key:0,class:"flex flex-wrap gap-2"},yr={key:1},hr={key:1,class:"flex"},gr={class:"flex-1 flex justify-end gap-1"},Ar={class:"flex justify-end flex-wrap gap-2"},br=Xe({__name:"TimeSheetDayDetailed",props:{user:{},targetSum:{},data:{},workingTimeModel:{}},emits:["submit","unsubmit","approve","decline"],setup(h,{emit:u}){const t=h,B=u,{t:v}=Ee(),g=ln(),y=ca().createScope(),k=pa().createScope(),{declinedAtMessage:o,approvedAtMessage:_}=ya(p(()=>t.data.timeSheetDay)),I=ce();Ya(rn,{formRef:I});const V=it();p(()=>({start:oa(t.data.date),end:ft(t.data.date)}));const j=yt($t,{interval:{seconds:5}}),R=yt(s=>{const d=ar(s);return Je(d,{year:t.data.date.getFullYear(),month:t.data.date.getMonth(),date:t.data.date.getDate()})},{interval:{minutes:5}}),c=yt(s=>{const d=tr(s);return Je(d,{year:t.data.date.getFullYear(),month:t.data.date.getMonth(),date:t.data.date.getDate()})},{interval:{minutes:5}}),J=g.useHasItems("assignment-event-work-types"),te=g.useHasItems("unaccountable-period-types"),O=ce(void 0);function G(s){if(s!==!0){if(!s){O.value=void 0;return}!J&&!te||(O.value={create:{data:{start:s.start,end:s.end},type:void 0}},De(J?te?void 0:"work-period":"unaccountable-period"))}}function we(s){O.value={item:s}}const N=ce(void 0);function X(s){const d=s.startsAt&&!s.isAllDay&&gt(s.startsAt,t.data.date)&&ve(t.data.date,s.startsAt)?s.startsAt:void 0,z=s.endsAt&&!s.isAllDay&&gt(s.endsAt,t.data.date)&&ve(t.data.date,s.endsAt)&&(!d||ve(d,s.endsAt))?s.endsAt:void 0;we(y.construct({companyId:s.companyId,assignmentId:s.assignmentId,eventId:s.id,user:t.user,start:d,end:z}))}function De(s){const d=O.value;!J&&!te||!d||!("create"in d)||(d.create.type=s,d.create.type&&(d.create.type==="work-period"?d.item=y.construct({start:d.create.data.start,end:d.create.data.end,user:t.user,companyId:t.user.companyId,manipulatedAt:new Date,manipulatedBy:V.value}):d.create.type==="unaccountable-period"&&(d.item=k.construct({start:d.create.data.start,end:d.create.data.end,user:t.user,companyId:t.user.companyId,manipulatedAt:new Date,manipulatedBy:V.value}))))}const ie=p(()=>{const s=Bt(R.value,{minutes:-30}),d=Je(t.data.date,{hours:5,minutes:0,seconds:0});return ve(s,t.data.date)?t.data.date:ve(s,d)?s:d}),L=p(()=>{if(!t.data.combinedWorkPeriods.length)return;const s=t.data.combinedWorkPeriods.reduce((d,z)=>!d||!z.start?d:!d.start||ve(z.start,d.start)?z:d);return s.start?Bt(Je(s.start,{minutes:0,seconds:0,milliseconds:0}),{hours:-1}):void 0}),Ie=p(()=>L.value?ve(L.value,t.data.date)?t.data.date:ve(ie.value,L.value)?ie.value:L.value:ie.value),se=ce(new Date(Ie.value));$e(Ie,s=>{ve(se.value,s)||(se.value=s)});const ye=p(()=>{const s=Bt(c.value,{minutes:-430}),d=ft(t.data.date),z=Je(t.data.date,{hours:18,minutes:0,seconds:0});return ve(d,s)?d:ve(z,s)?s:z}),Be=p(()=>{if(!t.data.combinedWorkPeriods.length)return;const s=t.data.combinedWorkPeriods.reduce((d,z)=>!d||!z.end?d:!d.end||ve(d.end,z.end)?z:d);return s.end?Bt(Je(s.end,{minutes:0,seconds:0,milliseconds:0}),{hours:2}):void 0}),Oe=p(()=>{if(!Be.value)return ye.value;const s=ft(t.data.date);return ve(s,Be.value)?s:ve(Be.value,ye.value)?ye.value:Be.value}),q=ce(new Date(Oe.value));$e(Oe,s=>{ve(s,q.value)||(q.value=s)});const fe=(s,d)=>s.extendedProps.type===d,{asyncRevertFunction:Re}=As({useNProgress:!0}),{assignmentEventsForUser:ue}=Ms({params:p(()=>({query:{startsAt:{$lt:ft(t.data.date)},endsAt:{$gt:t.data.date},$sort:{startsAt:1},$limit:-1},debounce:50})),user:V});function ge(s){s||="#fff";const d=new Hn(s);return d.getBrightness()>180?d.darken(20).toHexString():"transparent"}const{ref:E,options:Q}=bs({plugins:[gs,hs],initialView:"timeGridDay",headerToolbar:!1,allDaySlot:p(()=>t.data.hasAbsenceOrHoliday),dayHeaders:!1,slotMinTime:p(()=>xa(se.value,"HH:mm:ss")),slotMaxTime:p(()=>xa(q.value,"HH:mm:ss")),eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!1},selectable:p(()=>t.data.editable&&(!!J||!!te)),select:s=>{G({start:s.start,end:s.end})},editable:p(()=>t.data.editable),eventResizableFromStart:p(()=>t.data.editable),eventClick:({event:s})=>{fe(s,"workPeriod")?we(s.extendedProps.workPeriod):fe(s,"unaccountablePeriod")?we(s.extendedProps.unaccountablePeriod):fe(s,"absence")||fe(s,"holiday")},eventResize:Re(async({event:s})=>{if(!s.start||!s.end)return!1;if(fe(s,"workPeriod")){const{workPeriod:d}=s.extendedProps;d.start=s.start,d.end=s.end,d.manipulatedAt=new Date,d.manipulatedBy=V.value,await y.save(d)}else if(fe(s,"unaccountablePeriod")){const{unaccountablePeriod:d}=s.extendedProps;d.start=s.start,d.end=s.end,d.manipulatedAt=new Date,d.manipulatedBy=V.value,await k.save(d)}else return!1}),eventDrop:Re(async({event:s})=>{if(!s.start||!s.end)return!1;if(fe(s,"workPeriod")){const{workPeriod:d}=s.extendedProps;d.start=s.start,d.end=s.end,d.manipulatedAt=new Date,d.manipulatedBy=V.value,await y.save(d)}else if(fe(s,"unaccountablePeriod")){const{unaccountablePeriod:d}=s.extendedProps;d.start=s.start,d.end=s.end,d.manipulatedAt=new Date,d.manipulatedBy=V.value,await k.save(d)}else return!1}),events:p(()=>{const s=[];return t.data.workPeriods.forEach((d,z)=>{const{start:K}=d,ae=d.end||j.value;if(!K||!ae||ve(ae,K))return;const Ae=d.event?Ds(d.event):"#fff";s.push({start:K,end:ae,title:P(d.assignment),backgroundColor:Ae,textColor:d.event?Ts(d.event):"#000",editable:t.data.editable,borderColor:ge(Ae),className:"cursor-pointer overflow-hidden",extendedProps:{type:"workPeriod",workPeriod:d}})}),t.data.unaccountablePeriods.forEach((d,z)=>{const{start:K,type:ae}=d,Ae=d.end||j.value;!K||!Ae||ve(Ae,K)||!ae||s.push({start:K,end:Ae,title:ae.name,className:"cursor-pointer overflow-hidden",editable:t.data.editable,extendedProps:{type:"unaccountablePeriod",unaccountablePeriod:d}})}),t.data.userAbsences.forEach(d=>{const{id:z,startsAt:K,endsAt:ae,type:Ae,user:qe}=d;if(!K||!ae||ve(ae,K)||!z||!qe||!Ae)return;const Ue=ys(d);s.push({start:K,end:new Date(ae.getTime()+1),backgroundColor:Ue,textColor:sn(d),borderColor:ge(Ue),allDay:!0,editable:!1,title:Ae.name,extendedProps:{type:"absence",absence:d}})}),t.data.holidays.forEach(d=>{if(!d.startsAt||!d.endsAt)return;const z="#991b1b";s.push({start:d.startsAt,end:d.endsAt,backgroundColor:z,textColor:"#fff",borderColor:ge(z),allDay:!0,editable:!1,title:d.name,extendedProps:{type:"holiday",holiday:d}})}),s})},{calendarDate:()=>t.data.date});function We(){!O.value||!("item"in O.value)||(Me(O.value.item,"assignment-event-work-periods")?y.resetOrRemove(O.value.item):Me(O.value.item,"unaccountable-periods")&&k.resetOrRemove(O.value.item),G(!1))}const{validateAsync:Te}=dn(I),{execute:xe}=ea(async()=>{try{if(!O.value||!("item"in O.value))return;await Te();const{item:s}=O.value;s.manipulatedAt=new Date,s.manipulatedBy=V.value,Me(s,"assignment-event-work-periods")?await y.save(s):await k.save(s),G(!1)}catch{return}},{useNProgress:!0}),{execute:Le}=ea(async()=>{N.value&&(Me(N.value,"assignment-event-work-periods")?await y.remove(N.value):await k.remove(N.value),G(!1),N.value=void 0)}),{errors:A,warnings:Y}=nn(p(()=>t.data)),{getAssignmentNameToShow:P}=Ja();return(s,d)=>{const z=It,K=mt,ae=ua,Ae=Qa,qe=ut("font-awesome-icon"),Ue=ma;return l(),W("div",null,[r(fa,{class:"bg-gray-100 p-2 rounded shadow mb-2 flex-col gap-y-2"},{default:n(()=>[T("div",nr,[T("div",sr,[r(mn,{data:s.data},null,8,["data"]),s.data.canRecompute?(l(),w(re,{key:0,content:e(v)("actions.Refresh")},{default:n(()=>[r(K,{type:"primary",onClick:s.data.recompute},{default:n(()=>[r(z,null,{default:n(()=>[r(e(sa))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["content"])):S("",!0)]),T("div",or,[s.data.canSubmit?(l(),w(re,{key:0,content:e(v)("timeSheets.Submit")},{default:n(()=>[r(K,{type:"primary",plain:s.data.canApprove,onClick:d[0]||(d[0]=()=>B("submit",s.data.timeSheetDay))},{default:n(()=>[r(z,null,{default:n(()=>[r(e(At))]),_:1})]),_:1},8,["plain"])]),_:1},8,["content"])):S("",!0),s.data.canApprove?(l(),w(re,{key:1,content:s.data.timeSheetDay.approvedAt?e(_):e(v)("timeSheets.Approve")},{default:n(()=>[r(K,{type:"primary",disabled:!!s.data.timeSheetDay.approvedAt,onClick:d[1]||(d[1]=()=>B("approve",s.data.timeSheetDay))},{default:n(()=>[r(z,null,{default:n(()=>[r(e(Wt))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["content"])):S("",!0),s.data.canDecline?(l(),w(re,{key:2,content:s.data.timeSheetDay.declinedAt?e(o):e(v)("timeSheets.Decline")},{default:n(()=>[r(K,{type:"danger",disabled:!!s.data.timeSheetDay.declinedAt,plain:!s.data.timeSheetDay.declinedAt&&(!!s.data.timeSheetDay.approvedAt||!!s.data.timeSheetDay.declinedAt),onClick:d[2]||(d[2]=()=>B("decline",s.data.timeSheetDay))},{default:n(()=>[r(z,null,{default:n(()=>[r(e(xt))]),_:1})]),_:1},8,["disabled","plain"])]),_:1},8,["content"])):S("",!0)])]),s.data.editable||s.data.timeSheetDay.note?(l(),W("div",rr,[T("p",ir,f(e(v)("timeSheets.note"))+":",1),r(ae,{modelValue:s.data.timeSheetDay.note,"onUpdate:modelValue":d[3]||(d[3]=Z=>s.data.timeSheetDay.note=Z),disabled:!s.data.editable,rows:2,type:"textarea",placeholder:e(v)("timeSheets.note")},null,8,["modelValue","disabled","placeholder"])])):S("",!0),T("div",lr,[r(Et,{data:s.data,"working-time-model":s.workingTimeModel},null,8,["data","working-time-model"])])]),_:1}),r(un,{data:s.data,errors:e(A),warnings:e(Y),class:Se({"mb-2":!!e(A).length||!!e(Y).length})},null,8,["data","errors","warnings","class"]),e(ue).length?(l(),W("div",dr,[$(f(e(v)("timeSheets.scheduledEvents"))+": ",1),(l(!0),W(pe,null,Ke(e(ue),Z=>(l(),w(Bs,{key:Z.uuid,event:Z,class:"mb-1 cursor-pointer",onClick:()=>X(Z)},null,8,["event","onClick"]))),128))])):S("",!0),r(e(ks),{ref_key:"refCalendar",ref:E,options:e(Q)},{eventContent:n(({event:Z,timeText:et})=>[T("div",ur,f(et),1),fe(Z,"workPeriod")?(l(),W(pe,{key:0},[T("div",null,[T("span",null,f(e(P)(Z.extendedProps.workPeriod.assignment)),1),mr,Z.extendedProps.workPeriod.event?(l(),w(_s,{key:0,value:Z.extendedProps.workPeriod.event},null,8,["value"])):S("",!0)]),Z.extendedProps.workPeriod.type?(l(),W("div",cr,f(Z.extendedProps.workPeriod.type.name),1)):S("",!0),Z.extendedProps.workPeriod.note?(l(),W("div",pr,f(Z.extendedProps.workPeriod.note),1)):S("",!0)],64)):S("",!0),fe(Z,"unaccountablePeriod")?(l(),W(pe,{key:1},[T("div",null,f(Z.extendedProps.unaccountablePeriod.type?.name),1),Z.extendedProps.unaccountablePeriod.eventType?(l(),W("div",fr,f(Z.extendedProps.unaccountablePeriod.eventType.name),1)):S("",!0)],64)):fe(Z,"absence")||fe(Z,"holiday")?(l(),W(pe,{key:2},[$(f(Z.title),1)],64)):S("",!0)]),_:1},8,["options"]),e(O)?(l(),w(Ue,{key:1,"model-value":!!e(O),class:"dialog-messagebox-[500px]",title:"item"in e(O)?e(Me)(e(O).item,"assignment-event-work-periods")?e(v)("assignment-event-work-periods.name"):e(v)("unaccountable-work-periods.name"):"","onUpdate:modelValue":G},{footer:n(()=>[!("item"in e(O))||e(O).item.id&&!s.data.editable?(l(),W(pe,{key:0},["item"in e(O)?(l(),w(K,{key:0,type:"primary",onClick:d[6]||(d[6]=()=>G(!1))},{default:n(()=>[$(f(e(v)("actions.Close")),1)]),_:1})):S("",!0)],64)):(l(),W("div",hr,["item"in e(O)&&e(O).item.id?(l(),w(K,{key:0,type:"danger",onClick:d[7]||(d[7]=()=>N.value=e(O).item)},{default:n(()=>[r(qe,{icon:"trash-alt",class:"text-xs mr-2"}),$(" "+f(e(v)("actions.Delete")),1)]),_:1})):S("",!0),T("div",gr,["item"in e(O)?(l(),w(K,{key:0,class:"mr-2",text:"",onClick:We},{default:n(()=>[$(f(e(v)("actions.Cancel")),1)]),_:1})):S("",!0),"item"in e(O)?(l(),w(K,{key:1,type:"primary",onClick:e(xe)},{default:n(()=>[$(f(e(v)("timeSheets.form.enterPeriod")),1)]),_:1},8,["onClick"])):S("",!0)])]))]),default:n(()=>["create"in e(O)&&e(O).create.type===void 0?(l(),W("div",vr,[r(K,{type:"primary",onClick:d[4]||(d[4]=()=>De("work-period"))},{default:n(()=>[$(f(e(v)("assignment-event-work-periods.name")),1)]),_:1}),r(K,{type:"primary",onClick:d[5]||(d[5]=()=>De("unaccountable-period"))},{default:n(()=>[$(f(s.$t("unaccountable-work-periods.name")),1)]),_:1})])):"item"in e(O)?(l(),W("div",yr,[s.data.timeSheetDay.approvedAt||s.data.timeSheetDay.submittedAt?(l(),w(Ae,{key:0,title:s.data.timeSheetDay.approvedAt?e(v)("timeSheets.timeSheetIsAlreadyApproved"):e(v)("timeSheets.timeSheetAlreadySubmitted"),type:"info",closable:!1,class:"!mb-2"},null,8,["title"])):S("",!0),e(Me)(e(O).item,"assignment-event-work-periods")?(l(),w(Ss,{key:1,item:e(O).item,"hide-user-edit":"","limit-time-to-date":s.data.date,"allow-assignment-edit":!e(O).item.id||s.data.editable,"read-only":!!e(O).item.id&&!s.data.editable},null,8,["item","limit-time-to-date","allow-assignment-edit","read-only"])):e(Me)(e(O).item,"unaccountable-periods")?(l(),w(ws,{key:2,item:e(O).item,"hide-user-edit":"","limit-time-to-date":s.data.date,"read-only":!!e(O).item.id&&!s.data.editable},null,8,["item","limit-time-to-date","read-only"])):S("",!0)])):S("",!0)]),_:1},8,["model-value","title"])):S("",!0),e(N)?(l(),w(Ue,{key:2,"model-value":!!e(N),"onUpdate:modelValue":d[9]||(d[9]=()=>N.value=void 0)},{footer:n(()=>[T("div",Ar,[r(K,{text:"",onClick:d[8]||(d[8]=()=>N.value=void 0)},{default:n(()=>[$(f(e(v)("actions.Cancel")),1)]),_:1}),r(K,{type:"danger",onClick:e(Le)},{default:n(()=>[$(f(e(v)("actions.Delete")),1)]),_:1},8,["onClick"])])]),default:n(()=>[$(f(e(v)("feathersTablePagination.deleteQuestion"))+" ",1)]),_:1},8,["model-value"])):S("",!0)])}}}),Ga=60*4;function kr(h,u){const{endFallback:t=new Date,stopOnMultipleDays:B=!1}=u||{};let v=h.filter(o=>!!o.start).map(o=>({start:$t(o.start),end:$t(o.end||t)}));const g=Rn(v,"start")?.start??null,y=Ln(v,"end")?.end??null;if(g&&y&&g.getTime()>y.getTime())return{startsAt:g,endsAt:null,pauseDuration:0,error:"start_after_end"};if(B&&g&&y&&!gt(g,y))return{startsAt:g,endsAt:null,pauseDuration:0,error:"multiple_days"};v=tn(v,{ignoreGapSmallerThan:Ga});let k=0;for(let o=1;o<v.length;o++){const _=v[o-1],I=v[o],V=Math.abs(Xa(_.end,I.start));V<Ga||(k+=V)}return{startsAt:g,endsAt:y,pauseDuration:k}}function Sr(h){const u=Xn().createScope(),t=Zn().createScope(),{data:B,isPending:v}=u.useFind({params:p(()=>{const V=Pt(h);return V?V.workingTimeModelId?{query:{id:V.workingTimeModelId,$limit:1},$populateParams:{name:"withWeekdays"}}:{query:{isDefault:!0,deactivatedAt:null,$limit:1},$populateParams:{name:"withWeekdays"}}:null})}),g=p(()=>v.value?void 0:B.value.at(0)??null),{data:y,isPending:k}=t.useFind({params:p(()=>g.value?.id?{query:{workingTimeModelId:g.value.id,$sort:{weekday:1},$limit:-1}}:null)}),o=p(()=>v.value||k.value?void 0:y.value),_=p(()=>{if(!o.value)return;const V={};for(const j of Jn)V[j]=o.value.find(R=>R.weekday===j);return V}),I=p(()=>v.value||k.value);return{workingTimeModel:g,weekdayModels:o,weekdayModelByWeekday:_,isPending:I}}function Ct(h,u){if(Array.isArray(h)){const t=h.map(B=>Ct(B,u));return t.length===1?t[0]:{$or:t}}return u(h)}function pt(h){const{store:u,intervalToIgnore:t=1e3}=h,B=ce([]),v=ht(h.params),g=ht(h.fetchParams??h.params);$e(g,()=>{B.value=[]});const y=p(()=>{const j=Pt(h.dateRange);if(!j||!g.value)return null;const R=es(j,B.value);return R.length?{...g.value,query:{...qt(jt(g.value).query??{},Ct(R,h.formatFetch??h.format))}}:null}),{data:k,fetch:o,haveLoaded:_}=u.useFeathersItems({localOnly:!0,params:p(()=>!v.value||!B.value.length?null:{...v.value,query:{...qt(jt(v.value).query??{},Ct(B.value,h.format)),$limit:-1}}),fetchParams:y}),I=ce(!0),V=p(()=>{const j=Pt(h.dateRange),R=I.value||!j||!v.value?void 0:{...v.value,query:{...qt(jt(v.value).query??{},Ct(j,h.formatFetch??h.format))}};return R?u.findInStore(R):void 0});return $e(y,async j=>{const R=Pt(h.dateRange);if(!j||!R){I.value=!1;return}I.value=!0,await vt();try{await o(),B.value=tn([...B.value,R],{ignoreGapSmallerThan:t})}finally{await vt(),I.value=!1}},{immediate:!0}),{data:V,dataForAllRanges:k,isPending:I,haveLoaded:_}}const wr={class:"time-sheet-view"},Dr={class:"flex justify-between items-center flex-wrap md:flex-nowrap mb-2"},Tr={class:"hidden sm:block"},_r={class:"block sm:hidden"},Mr={class:"ml-2"},Br={class:"flex justify-end mt-2"},Pr={class:"text-gray-500 mb-1"},Cr={class:"mb-2"},Pi=Xe({__name:"ViewTimeSheet",setup(h){const{t:u}=Ee(),t=it(),B=ts(),v=Za(),g=as().createScope(),y=ns().createScope(),k=ss().createScope(),o=os().createScope(),_=ca().createScope(),I=pa().createScope(),V=rs().createScope(),j=ta(["superadmin","admin"]),R=ta(["superadmin","admin","office"]),c=is(ls.ViewTimeSheetDays,fs),J=p({get(){return c.view==="date"?c.date:c.view==="week"?Ua(c.date):Na(c.date)},set(i){c.date=i}}),te=yt($t,{interval:{minutes:2}}),O=ce(void 0);function G(i,a){if(!(i===!0||Array.isArray(i)&&!i.length)){if(!i){O.value=void 0;return}if(i){if(Array.isArray(i)){O.value={days:i,month:a};return}O.value={days:[i],month:a}}j.value&&we()}}function we(){if(!O.value||!Pe.value){G(!1);return}const{days:i,month:a}=O.value;ga(i),a&&pn(a),G(!1)}const N=p(()=>c.view==="month"?{start:Na(c.date),end:Yn(c.date)}:c.view==="date"?{start:oa(c.date),end:ft(c.date)}:{start:Ua(c.date),end:Qn(c.date)}),X=p(()=>{const i=new Date;return Gt({start:N.value.start,end:N.value.end}).map(a=>({date:a,numberOfWeek:Is(a),isToday:Jt(a),isTodayOrBefore:ve(a,i),key:ke(a),title:ze(a,"EEEEEE, dd.")}))}),De=p(()=>{const i={};for(const a of X.value)i[a.key]=a;return i}),ie=p({get(){return c.userId??t.value?.id??void 0},set(i){c.userId=i??void 0}}),L=$s(ie,g),Ie=p(()=>j.value?{query:{$sort:{fullName:1},deactivatedAt:null}}:{query:{$sort:{fullName:1},deactivatedAt:null,$or:[{supervisorId:t.value?.id},{id:t.value?.id}]}}),{workingTimeModel:se,weekdayModelByWeekday:ye}=Sr(L),{data:Be,isPending:Oe}=pt({store:y,format:i=>({day:{$gteDateString:ke(i.start),$lteDateString:ke(i.end)}}),formatFetch:i=>({day:{$gte:ke(i.start),$lte:ke(i.end)}}),dateRange:N,params:p(()=>ie.value?{query:{userId:ie.value,$limit:100}}:null),fetchParams:p(()=>ie.value?{query:{userId:ie.value,$limit:100}}:null)}),q=ce(void 0);$e([Oe,Be,L,X],async()=>{if(q.value=void 0,Oe.value||!L.value||!Be.value)return;await vt();const i=L.value,a=Be.value;if(!i||!a)return;let m={};const b=[];X.value.forEach(D=>{const x=a.find(C=>C.day===D.key);x?m&&(m[D.key]=x):(b.push({companyId:i.companyId,day:D.key,userId:i.id,pauseDuration:0,duration:0}),m=void 0)}),b.length&&await y.create(b),m&&(q.value=m)},{immediate:!0});const{data:fe,isPending:Re}=pt({store:k,format:i=>({startsAt:{$lte:i.end},endsAt:{$gte:i.start}}),dateRange:N,params:p(()=>B.value?{query:{companyId:B.value,$limit:100}}:null)}),ue=p(()=>{if(Re.value||!fe.value)return;const i={};for(const a of fe.value){const m=a.startsAt,b=a.endsAt,D=Gt({start:m,end:b});for(const x of D){const C=ke(x);i[C]||(i[C]=[]),i[C].push(a)}}return i}),{data:ge,isPending:E}=pt({store:o,format:i=>({startsAt:{$lte:i.end},endsAt:{$gte:i.start}}),dateRange:N,params:p(()=>ie.value?{query:{userId:ie.value,status:"approved",$limit:100}}:null)}),Q=p(()=>[...new Set(ge.value?.map(i=>i.typeId))].filter(Ge)),{isPending:We}=V.useFindOnce({items:Q,params:p(()=>Q.value.length?{query:{id:{$in:Q.value},$limit:-1}}:null),fetchParams:i=>({query:{id:{$in:i},$limit:-1}})}),Te=p(()=>{if(E.value||We.value||!ge.value)return;const i={};for(const a of ge.value){const m=a.startsAt,b=a.endsAt;if(!m||!b)continue;const D=Gt({start:m,end:b});for(const x of D){const C=ke(x);i[C]||(i[C]=[]),i[C].push(a)}}return i}),{data:xe,isPending:Le}=pt({store:_,format:i=>({start:{$gte:i.start,$ne:null}}),dateRange:N,params:p(()=>ie.value?{query:{id:{$ne:null},userId:ie.value,$limit:-1}}:null)}),A=p(()=>{if(Le.value||!xe.value)return;const i={};for(const a of xe.value){if(!a.start)continue;const m=ke(a.start);i[m]||(i[m]=[]),i[m].push(a)}return i}),{data:Y,isPending:P}=pt({store:I,format:i=>({start:{$gte:i.start,$ne:null}}),dateRange:N,params:p(()=>ie.value?{query:{id:{$ne:null},userId:ie.value,$limit:-1}}:null)}),s=p(()=>{if(P.value||!Y.value)return;const i={};for(const a of Y.value){if(!a.start)continue;const m=ke(a.start);i[m]||(i[m]=[]),i[m].push(a)}return i}),d=p(()=>{const i={};if(!(!A.value||!s.value)){for(const a of X.value){const m=A.value[a.key]??[],b=s.value[a.key]??[];i[a.key]=[...m,...b].sort((D,x)=>!D.start||!x.start?0:D.start.getTime()-x.start.getTime())}return i}}),z=p(()=>{if(!d.value)return;const i={};for(const a of X.value){const m=d.value[a.key]??[];i[a.key]=kr(m,{endFallback:te.value,stopOnMultipleDays:!0})}return i}),K=p(()=>{if(!d.value)return;const i={};for(const a of X.value){if(!d.value[a.key])return;const m=d.value[a.key];i[a.key]=m.some(b=>b.start?!gt(b.start,b.end??te.value):!1)}return i}),ae=p(()=>{if(!q.value||!Te.value||!ue.value||!d.value)return;const i={};for(const a of X.value){if(!q.value[a.key])return;const b=d.value[a.key];i[a.key]=!Te.value[a.key]?.length&&!ue.value[a.key]?.length||(b?.length??0)>0}return i}),Ae=p(()=>{const i=se.value;if(!i?.pauseRules||!Array.isArray(i.pauseRules)||i.pauseRules.length===0)return;const a=[...i.pauseRules].sort((m,b)=>(b.durationMin??0)-(m.durationMin??0));if(a.length)return a}),qe=p(()=>{if(!z.value||!q.value||se.value===void 0||!ye.value)return;const i={};se.value;for(const a of X.value){const m=z.value[a.key],b=q.value[a.key];if(!m||!b)return;const D=ye.value[a.numberOfWeek],x=(()=>{const U=(ee,M,oe)=>{const be=typeof ee=="number"?Je(a.date,qa(ee,{pick:["hours","minutes","seconds"],unitInput:"seconds"})):ee;return{startsAtCorrected:be,startsAtCorrectedType:M,startsAtCorrectedTypeLabel:M==="computed"||M==="not set"||!be?"":M==="manually"?u("timeSheets.changedByWorkingTimeModel.startsAt.manual"):M==="default"?u("timeSheets.changedByWorkingTimeModel.startsAt.default"):oe?u("timeSheets.changedByWorkingTimeModel.startsAt.corrected",{real:ja(oe)}):""}};if(b.startsAtManipulatedAt)return U(m.startsAt,"manually");if(!D)return U(m.startsAt,"computed");if(!m.startsAt)return D.start?U(D.start,"default",m.startsAt):D.startMin?U(D.startMin,"min",m.startsAt):U(null,"not set");const ne=Ra(La(m.startsAt,["hours","minutes","seconds"]),"seconds");return D.startMin&&ne<D.startMin?U(D.startMin,"min",m.startsAt):D.startMax&&ne>D.startMax?U(D.startMax,"max",m.startsAt):U(m.startsAt,"computed")})(),C=(()=>{const U=(ee,M,oe)=>{const be=typeof ee=="number"?Je(a.date,qa(ee,{pick:["hours","minutes","seconds"],unitInput:"seconds"})):ee;return{endsAtCorrected:be,endsAtCorrectedType:M,endsAtCorrectedTypeLabel:M==="computed"||M==="not set"||!be?"":M==="manually"?u("timeSheets.changedByWorkingTimeModel.endsAt.manual"):M==="default"?u("timeSheets.changedByWorkingTimeModel.endsAt.default"):oe?u("timeSheets.changedByWorkingTimeModel.endsAt.corrected",{real:ja(oe)}):""}};if(b.endsAtManipulatedAt)return U(m.endsAt,"manually");if(!D)return U(m.endsAt,"computed");if(!m.endsAt)return D.end?U(D.end,"default",m.endsAt):D.endMin?U(D.endMin,"min",m.endsAt):U(null,"not set");const ne=Ra(La(m.endsAt,["hours","minutes","seconds"]),"seconds");return D.end&&ne<D.end?U(D.end,"min",m.endsAt):D.endMax&&ne>D.endMax?U(D.endMax,"max",m.endsAt):U(m.endsAt,"computed")})(),le=(()=>{const U=(M,oe,be)=>{const nt=M??0;return{pauseDurationCorrected:nt,pauseDurationCorrectedType:oe,pauseDurationCorrectedTypeLabel:oe==="computed"||oe==="not set"||!nt?"":oe==="manually"?u("timeSheets.changedByWorkingTimeModel.pauseDuration.manual"):oe==="default"?u("timeSheets.changedByWorkingTimeModel.pauseDuration.default"):be?u("timeSheets.changedByWorkingTimeModel.pauseDuration.corrected",{real:cs(be,{hours:"always",minutes:"always"}).result}):""}};if(b.pauseDurationManipulatedAt)return U(m.pauseDuration,"manually");if(!x.startsAtCorrected||!C.endsAtCorrected)return U(m.pauseDuration,"computed");const ne=Ae.value;if(!ne)return U(m.pauseDuration,"computed");const ee=Math.max(0,Math.round((C.endsAtCorrected.getTime()-x.startsAtCorrected.getTime())/1e3));for(let M=0;M<ne.length;M++){const oe=ne[M],{breakTimeDefault:be,durationMin:nt,breakTimeMin:st,breakTimeMax:ot}=oe;if(ee<(nt??0))continue;let rt="computed",Ze=m.pauseDuration;return Ze||(rt="default",Ze=be??0),st!=null&&Ze<st?U(st,"min",m.pauseDuration):ot!=null&&Ze>ot?U(ot,"max",m.pauseDuration):U(Ze,rt,m.pauseDuration)}return U(m.pauseDuration,"computed")})();i[a.key]={...x,...C,...le}}return i}),Ue=p(()=>se.value?.countHolidaysAsWorkdays??!1),Z=p(()=>{if(!Te.value||!ue.value||!ae.value||!z.value||!qe.value||!L.value||se.value===void 0||!ye.value)return;const i={};for(const a of X.value){const m=Te.value[a.key]??[],b=ue.value[a.key]??[],D=ae.value[a.key],x=z.value[a.key],C=qe.value[a.key],{startsAt:le,endsAt:U,pauseDuration:ne}=a.isTodayOrBefore?{startsAt:C.startsAtCorrected,endsAt:C.endsAtCorrected,pauseDuration:C.pauseDurationCorrected}:x,ee={startsAt:le,endsAt:U,pauseDuration:ne??0,day:a.date,userId:L.value.id,companyId:L.value.companyId},M=ye.value[a.numberOfWeek];if(M&&!D){const{duration:oe}=M;if(oe){i[a.key]={...ee,duration:b.length?Ue.value?oe:0:m.some(be=>be.type?.countAsWorkingTime)?oe:0};continue}}i[a.key]=ee}return i}),et=p(()=>{if(!q.value||!ae.value||!Z.value)return;const i={};for(const a of X.value){const m=q.value[a.key];if(m.submittedAt)continue;const b=Z.value[a.key],D=ae.value[a.key],x=D&&b.startsAt&&m.startsAt?.getTime()!==b.startsAt.getTime()?b.startsAt:void 0,C=D&&b.endsAt&&m.endsAt?.getTime()!==b.endsAt.getTime()?b.endsAt:void 0,le=D&&"pauseDuration"in b&&m.pauseDuration!==b.pauseDuration?b.pauseDuration:void 0,U="duration"in b&&m.duration!==b.duration?b.duration:void 0;x===void 0&&C===void 0&&le===void 0&&U===void 0||(i[a.key]={startsAt:x,endsAt:C,pauseDuration:le,duration:U})}return i}),bt=p(()=>L.value?L.value.supervisorId===t.value?.id:!1),kt=p(()=>{if(!q.value)return;const i={};for(const a of X.value){const m=q.value[a.key];if(!m)return;i[a.key]=m.submittedAt?void 0:m}return i}),F=p(()=>{if(!q.value)return;const i={},a=bt.value||j.value;for(const m of X.value){const b=q.value[m.key];if(!b)return;i[m.key]=a&&b.submittedAt&&!b.declinedAt&&!b.approvedAt?b:void 0}return i}),Fe=p(()=>{if(!q.value)return;const i={},a=bt.value||j.value;for(const m of X.value){const b=q.value[m.key];if(!b)return;i[m.key]=b.submittedAt&&!b.declinedAt&&a?b:void 0}return i}),St=p(()=>{if(!q.value)return;const i={};for(const a of X.value){const m=q.value[a.key];if(!m)return;i[a.key]=m.submittedAt&&!m.approvedAt?m:void 0}return i}),wt=p(()=>{if(!q.value||se.value===void 0||!ae.value)return;const i=Ae.value;if(!i)return{};const a={};for(const m of X.value){const b=q.value[m.key];if(!b)return;const{startsAt:D,endsAt:x}=b,C=b.pauseDuration??0;if(!ae.value?.[m.key]||!D||!x)continue;const le=Math.max(0,Math.round((x.getTime()-D.getTime())/1e3));let U=!1;for(const ne of i){const{durationMin:ee,breakTimeMin:M,breakTimeMax:oe}=ne;if((le??0)<(ee??0)){U=!0;continue}if(M!=null&&C<M){a[m.key]={type:"pauseTooShort",expected:M,value:C,durationMin:ee??0},U=!0;break}else if(oe!=null&&C>oe){a[m.key]={type:"pauseTooLong",expected:oe,value:C,durationMin:ee??0},U=!0;break}}}return a}),Nt=p(()=>{if(!q.value||ye.value===void 0||!ae.value)return;const i={};for(const a of X.value){const m=q.value[a.key],b=ae.value[a.key];if(!m||b===void 0)return;const D=ye.value[a.numberOfWeek];!b||!D?.durationMax||D.durationMax>(m.duration??0)||(i[a.key]={type:"durationTooLong",expected:D.durationMax,value:m.duration??0})}return i}),cn=p(()=>{if(!et.value||!q.value)return;const i=[];for(const a of X.value){const m=q.value[a.key],b=et.value[a.key];if(!m)return;if(!b)continue;let D;b.startsAt&&!m.startsAtManipulatedAt&&(D=D??{key:a.key},D.startsAt=b.startsAt),b.endsAt&&!m.endsAtManipulatedAt&&(D=D??{key:a.key},D.endsAt=b.endsAt),b.pauseDuration!==void 0&&!m.pauseDurationManipulatedAt&&(D=D??{key:a.key},D.pauseDuration=b.pauseDuration),b.duration!==void 0&&!m.durationManipulatedAt&&(D=D??{key:a.key},D.duration=b.duration),D&&i.push(D)}return i});function ha(i,a){const{timeSheetDay:m,userAbsences:b,holidays:D}=a,x=ye.value;return D.length&&!a.showStartsAtEndsAt?Ue.value?x?.[i.numberOfWeek]?.duration??0:0:b.length&&!a.showStartsAtEndsAt&&x?.[i.numberOfWeek]?x[i.numberOfWeek].duration??0:!m?.startsAt||!m?.endsAt||m.startsAt>m.endsAt?0:Math.max(0,Math.abs(Xa(m.endsAt,m.startsAt))-(m.pauseDuration??0))}const Ft=ce(!1);$e(cn,async(i,a)=>{if(!i&&a){Ft.value=!1;return}if(!(!i||!q.value||!De.value||!ae.value||!Te.value||!ue.value)){for(const m of i){const{key:b,startsAt:D,endsAt:x,pauseDuration:C,duration:le}=m,U=q.value[b];if(!U||!De.value[b])continue;let ne=!1;if(D&&(U.startsAt=D,ne=!0),x&&(U.endsAt=x,ne=!0),C!==void 0&&(U.pauseDuration=C,ne=!0),le!==void 0&&(U.duration=le),ne){const ee=ha(De.value[b],{timeSheetDay:U,userAbsences:Te.value[b]??[],holidays:ue.value[b]??[],showStartsAtEndsAt:ae.value[b]??!1});ee!==void 0&&(U.duration=ee)}}a||(await vt(),Ft.value=!0)}},{immediate:!0});const{submit:ga,unsubmit:Aa,approve:Dt,decline:ba}=Os(),{submit:pn,decline:fn}=Ws(),Pe=p(()=>{const i=kt.value,a=F.value,m=Fe.value,b=St.value;if(!i||!a||!m||!b)return;const D=Object.values(i).filter(Ge),x=Object.values(a).filter(Ge),C=Object.values(m).filter(Ge),le=Object.values(b).filter(Ge),U=D.length>0,ne=x.length>0,ee=C.length>0,M=le.length>0;return{submit:()=>{if(U)return ga(D)},approve:()=>{if(ne)return Dt(x)},decline:rt=>{if(ee)return ba(C,rt)},unsubmit:()=>{if(M)return Aa(le)},timeSheetsToSubmit:D,timeSheetsToApprove:x,timeSheetsToDecline:C,timeSheetsToUnsubmit:le,canSubmit:U,canApprove:ne,canDecline:ee,canUnsubmit:M}}),Vt=ce(null),ka=ce(0);$e(Vt,async i=>{i&&(ka.value=Date.now(),await vt(),i.focus())});function vn(){Date.now()-ka.value<250&&Vt.value?.focus()}const Ve=ce(void 0),tt=ce("");function je(i,a){if(!(i===!0||Array.isArray(i)&&!i.length))if(i){if(Array.isArray(i)){Ve.value={days:i,month:a};return}Ve.value={days:[i],month:a};return}else Ve.value=void 0,tt.value=""}function Sa(){if(!Ve.value){je(!1);return}ba(Ve.value.days,tt.value),Ve.value.month&&fn(Ve.value.month,tt.value),je(!1)}const at=p(()=>{const i=q.value,a=ue.value,m=Te.value,b=A.value,D=s.value,x=Z.value,C=qe.value,le=et.value,U=d.value,ne=Ft.value,ee=kt.value,M=F.value,oe=Fe.value,be=St.value,nt=se.value,st=ye.value,ot=wt.value,rt=Nt.value,Ze=ae.value,wa=K.value;return!i||!a||!m||!b||!D||!x||!C||!le||!U||!ne||!ee||!M||!oe||!be||nt===void 0||st===void 0||!ot||!rt||!Ze||!wa?void 0:X.value.map(Tt=>{const{key:he}=Tt,H=i[he],Rt=a[he]??[],Lt=m[he]??[],An=b[he]??[],bn=D[he]??[],ct=x[he],kn=C[he],Da=le[he],Ta=!!ee[he],Sn=!!M[he],wn=!!oe[he],Dn=!!be[he],_a=U[he],Tn=ot[he],_n=rt[he],Ma=Ze[he],Mn=wa[he],Bn=st[Tt.numberOfWeek];if(!H)return;const Ba=Rt.length>0||Lt.length>0,Pa=_a.filter(de=>!!de.manipulatedAt).sort((de,me)=>!de.manipulatedAt||!me.manipulatedAt?0:de.manipulatedAt.getTime()-me.manipulatedAt.getTime()),Ca=Pa.find(de=>!!de.manipulatedByUuid)??Pa.at(0)??null,Pn=H.manipulatedBy??Ca?.manipulatedBy??void 0,_t=()=>ha(Tt,{timeSheetDay:H,userAbsences:Lt,holidays:Rt,showStartsAtEndsAt:Ma}),Cn=!H.submittedAt||j.value&&!H.approvedAt;return{...Tt,timeSheetDay:H,holidays:Rt,userAbsences:Lt,workPeriods:An,unaccountablePeriods:bn,hasAbsenceOrHoliday:Ba,manipulatedByUser:Pn,combinedWorkPeriods:_a,lastManipulatedPeriod:Ca,prefilled:ct,corrected:kn,mismatch:Da,canSubmit:Ta,canApprove:Sn,canDecline:wn,canUnsubmit:Dn,canRecompute:Ta&&!!Da,get startsAt(){return H.startsAt??null},set startsAt(de){H.startsAt=de;const me=_t();me!==void 0&&(H.duration=me)},get endsAt(){return H.endsAt??null},set endsAt(de){H.endsAt=de;const me=_t();me!==void 0&&(H.duration=me)},get pauseDuration(){return H.pauseDuration??0},set pauseDuration(de){H.pauseDuration=de;const me=_t();me!==void 0&&(H.duration=me)},get duration(){return H.duration??0},set duration(de){H.duration=de,H.startsAt=null,H.endsAt=null,H.pauseDuration=null},manipulateByHand(de,me){if(H.manipulatedAt=new Date,H.manipulatedBy=t.value,de==="startsAt"){if(Mt(this.startsAt,me))return;H.startsAtManipulatedAt||(H.startsAtManipulatedAt=new Date),this.startsAt=me}else if(de==="endsAt"){if(Mt(this.endsAt,me))return;H.endsAtManipulatedAt||(H.endsAtManipulatedAt=new Date),this.endsAt=me}else if(de==="pauseDuration"){if(Mt(this.pauseDuration,me))return;H.pauseDurationManipulatedAt||(H.pauseDurationManipulatedAt=new Date),this.pauseDuration=me}else if(de==="duration"){if(Mt(this.duration,me))return;H.durationManipulatedAt||(H.durationManipulatedAt=new Date),this.duration=me}},recompute(){if(H.manipulatedAt=null,H.startsAtManipulatedAt=null,H.endsAtManipulatedAt=null,H.pauseDurationManipulatedAt=null,H.durationManipulatedAt=null,H.manipulatedBy=null,Ba)H.duration=ct.duration??0;else{H.startsAt=ct.startsAt??null,H.endsAt=ct.endsAt??null,H.pauseDuration=ct.pauseDuration??0;const de=_t();de!==void 0&&(H.duration=de)}},editable:Cn,pauseError:Tn,durationError:_n,showStartsAtEndsAt:Ma,hasMultipleDays:Mn,workingTimeModelWeekday:Bn}})}),lt=ce(void 0),dt=ce(!1),yn=ds(async()=>{if(!se.value||!L.value||!N.value){dt.value=!1,lt.value=void 0;return}dt.value=!0;try{const i=await ms.service("calculate-working-times").calculateWorkingDaysForDateRange({companyId:L.value.companyId,userId:L.value.id,start:N.value.start,end:N.value.end});lt.value=i.duration}finally{dt.value=!1}},350);$e([se,L,N],(i,a,m)=>{lt.value=void 0,dt.value=!!i&&!!a&&!!m,yn()},{immediate:!0}),qn(q,i=>{if(!i||y.isSaving.value)return;const a=Object.values(i).filter(m=>!m.id||y.hasChanges(m));a.length&&y.save(a)},{throttle:300,leading:!1,trailing:!0,deep:!0});const Ht=p(()=>!!se.value?.showIsManipulated),{stringifyAndDownloadCsv:hn}=Es();function gn(){if(!at.value||!L.value)return;const i=L.value,a=at.value.map(x=>{const{timeSheetDay:C}=x,le=C.approvedAt?u("timeSheets.csv.state.approved"):C.declinedAt?u("timeSheets.csv.state.declined"):!C.id||!C.submittedAt?u("timeSheets.csv.state.draft"):C.submittedAt&&!C.approvedAt&&!C.declinedAt?u("timeSheets.csv.state.unapproved"):"";return{staffNumber:i.staffNumber??`${i.id}`,weekday:ze(x.date,"EEEEEE"),date:ze(x.date,"dd.MM.yyyy"),start:C.startsAt?ze(C.startsAt,"HH:mm"):"",end:C.endsAt?ze(C.endsAt,"HH:mm"):"",breakTime:C.pauseDuration!=null?Fa(C.pauseDuration,{hours:!0,minutes:!0}):"",durationFloating:C.duration!=null?parseFloat((C.duration/60/60).toFixed(2)):"",durationTime:C.duration!=null?Fa(C.duration,{hours:!0,minutes:!0}):"",note:C.note??"",declineReason:C.declinedNote??"",absence:x.holidays[0]?.name??x.userAbsences[0]?.type?.name??"",state:le,manipulated:Ht.value?C.manipulatedAt?C.manipulatedBy?u("timeSheets.manipulated.fullBy",{user:C.manipulatedBy.shortName||C.manipulatedBy.fullName}):u("timeSheets.manipulated.full"):x.lastManipulatedPeriod?x.lastManipulatedPeriod.manipulatedBy?u("timeSheets.manipulated.fullBy",{user:x.lastManipulatedPeriod.manipulatedBy.shortName||x.lastManipulatedPeriod.manipulatedBy.fullName}):u("timeSheets.manipulated.full"):"":""}}),m=c.view==="month"?u("Month"):c.view==="date"?u("Day"):u("Week"),b=ze(c.date,c.view==="month"?"MM-yy":c.view==="date"?"dd-MM-yy":`'${u("calendar.cw")}'ww-yy`),D=`Artesa_AZN_${(i.shortName||i.fullName||u("unknown")).replace(/\s/gm,"_")}_${m}_${b}_${ze(new Date,"yyyyMMdd-HHmmss")}.csv`;hn(a,{columns:[{key:"staffNumber",header:u("timeSheets.csv.header.staffNumber")},{key:"weekday",header:u("timeSheets.csv.header.weekday")},{key:"date",header:u("timeSheets.csv.header.date")},{key:"start",header:u("timeSheets.csv.header.start")},{key:"end",header:u("timeSheets.csv.header.end")},{key:"breakTime",header:u("timeSheets.csv.header.breakTime")},{key:"durationFloating",header:u("timeSheets.csv.header.durationFloating")},{key:"durationTime",header:u("timeSheets.csv.header.durationTime")},{key:"absence",header:u("timeSheets.csv.header.absence")},{key:"state",header:u("timeSheets.csv.header.state")},{key:"note",header:u("timeSheets.csv.header.note")},{key:"declineReason",header:u("timeSheets.csv.header.declineReason")},...Ht.value?[{key:"manipulated",header:u("timeSheets.manipulated.full")}]:[]]},D)}return(i,a)=>{const m=zn,b=Gn,D=ut("font-awesome-icon"),x=mt,C=da,le=ra,U=ia,ne=ma,ee=la;return Ut((l(),W("div",wr,[r(us),T("div",Dr,[r(Ps,{modelValue:e(J),"onUpdate:modelValue":a[0]||(a[0]=M=>zt(J)?J.value=M:null),clearable:!1,resolution:e(c).view,"class-button-today":"hidden sm:block"},null,8,["modelValue","resolution"]),T("div",Tr,[r(b,{modelValue:e(c).view,"onUpdate:modelValue":a[1]||(a[1]=M=>e(c).view=M)},{default:n(()=>[r(m,{value:"month"},{default:n(()=>[$(f(e(u)("Month")),1)]),_:1}),r(m,{value:"week"},{default:n(()=>[$(f(e(u)("Week")),1)]),_:1}),r(m,{value:"date"},{default:n(()=>[$(f(e(u)("Day")),1)]),_:1})]),_:1},8,["modelValue"])]),T("div",_r,[r(U,{onCommand:a[2]||(a[2]=M=>e(c).view=M)},{dropdown:n(()=>[r(le,null,{default:n(()=>[r(C,{disabled:e(c).view==="month",command:"month"},{default:n(()=>[r(D,{icon:"calendar-alt",class:"mr-2 text-xs"}),$(" "+f(e(u)("Month")),1)]),_:1},8,["disabled"]),r(C,{disabled:e(c).view==="week",command:"week"},{default:n(()=>[r(D,{icon:"calendar-week",class:"mr-2 text-xs"}),$(" "+f(e(u)("Week")),1)]),_:1},8,["disabled"]),r(C,{disabled:e(c).view==="date",command:"date"},{default:n(()=>[r(D,{icon:"calendar-day",class:"mr-2 text-xs"}),$(" "+f(e(u)("Day")),1)]),_:1},8,["disabled"])]),_:1})]),default:n(()=>[r(x,{type:"primary"},{default:n(()=>[r(D,{icon:e(c).view==="month"?"calendar-alt":e(c).view==="week"?"calendar-week":"calendar-day"},null,8,["icon"]),T("span",Mr,f(e(c).view==="month"?e(u)("Month"):e(c).view==="week"?e(u)("Week"):e(u)("Day")),1)]),_:1})]),_:1})]),e(R)?(l(),w(Cs,{key:0,modelValue:e(L),"onUpdate:modelValue":a[3]||(a[3]=M=>zt(L)?L.value=M:null),"show-name":e(v).md,size:"medium",params:e(Ie)},null,8,["modelValue","show-name","params"])):S("",!0)]),e(at)&&e(L)&&e(Pe)&&e(se)!==void 0&&e(ye)!==void 0?(l(),W(pe,{key:0},[e(c).view==="month"?(l(),w(eo,{key:0,user:e(L),month:e(J),"day-data":e(at),"target-sum":e(lt),actions:e(Pe),"working-time-model":e(se),"is-pending-calculated-target-working-time":e(dt),onSubmitAll:a[4]||(a[4]=({timeSheetMonth:M})=>G(e(Pe)?.timeSheetsToSubmit??[],M)),onApproveAll:a[5]||(a[5]=()=>e(Pe)?.approve()),onDeclineAll:a[6]||(a[6]=({timeSheetMonth:M})=>je(e(Pe)?.timeSheetsToDecline??[],M)),onUnsubmitAll:a[7]||(a[7]=()=>e(Pe)?.unsubmit()),onSubmit:a[8]||(a[8]=M=>G(M)),onApprove:a[9]||(a[9]=M=>e(Dt)(M)),onDecline:a[10]||(a[10]=M=>je(M)),onGoToDate:a[11]||(a[11]=M=>(J.value=M,e(c).view="date"))},null,8,["user","month","day-data","target-sum","actions","working-time-model","is-pending-calculated-target-working-time"])):e(c).view==="week"?(l(),w(er,{key:1,user:e(L),date:e(J),"day-data":e(at),"target-sum":e(lt),actions:e(Pe),"working-time-model":e(se),"is-pending-calculated-target-working-time":e(dt),"show-is-manipulated":e(Ht),onSubmitAll:a[12]||(a[12]=()=>G(e(Pe)?.timeSheetsToSubmit??[])),onApproveAll:a[13]||(a[13]=()=>e(Pe)?.approve()),onDeclineAll:a[14]||(a[14]=()=>je(e(Pe)?.timeSheetsToDecline??[])),onUnsubmitAll:a[15]||(a[15]=()=>e(Pe)?.unsubmit()),onSubmit:a[16]||(a[16]=M=>G(M)),onApprove:a[17]||(a[17]=M=>e(Dt)(M)),onDecline:a[18]||(a[18]=M=>je(M)),onGoToDate:a[19]||(a[19]=M=>(J.value=M,e(c).view="date"))},null,8,["user","date","day-data","target-sum","actions","working-time-model","is-pending-calculated-target-working-time","show-is-manipulated"])):e(c).view==="date"?(l(),w(br,{key:2,user:e(L),data:e(at)[0],"target-sum":e(lt),"working-time-model":e(se),onSubmit:a[20]||(a[20]=M=>G(M)),onUnsubmit:a[21]||(a[21]=M=>e(Aa)(M)),onApprove:a[22]||(a[22]=M=>e(Dt)(M)),onDecline:a[23]||(a[23]=M=>je(M))},null,8,["user","data","target-sum","working-time-model"])):S("",!0)],64)):S("",!0),T("div",Br,[r(x,{onClick:gn},{default:n(()=>[r(D,{icon:"download",class:"mr-2"}),$(" "+f(e(u)("timeSheets.csvExport")),1)]),_:1})]),e(Ve)?(l(),w(ne,{key:1,"model-value":!!e(Ve),width:"95%",class:"max-w-lg",title:e(u)("timeSheets.confirmDecline.dialogTitle"),"onUpdate:modelValue":je},{footer:n(()=>[r(x,{class:"mr-2",text:"",onClick:a[26]||(a[26]=()=>je(!1))},{default:n(()=>[$(f(e(u)("actions.Cancel")),1)]),_:1}),e(Ve)?(l(),w(x,{key:0,type:"danger",disabled:!e(tt),onClick:Sa},{default:n(()=>[$(f(e(u)("actions.Decline")),1)]),_:1},8,["disabled"])):S("",!0)]),default:n(()=>[T("div",Pr,f(e(u)("timeSheets.confirmDecline.dialogQuestion")),1),r(e(ua),{ref_key:"refDeclineInput",ref:Vt,modelValue:e(tt),"onUpdate:modelValue":a[24]||(a[24]=M=>zt(tt)?tt.value=M:null),onBlur:vn,onKeydown:a[25]||(a[25]=jn(Zt(()=>Sa(),["prevent"]),["enter"]))},null,8,["modelValue"])]),_:1},8,["model-value","title"])):S("",!0),e(O)?(l(),w(ne,{key:2,"model-value":!!e(O),width:"95%",class:"max-w-lg",title:e(u)("timeSheets.confirmSubmit.dialogTitle"),"onUpdate:modelValue":G},{footer:n(()=>[r(x,{class:"mr-2",text:"",onClick:a[27]||(a[27]=()=>G(!1))},{default:n(()=>[$(f(e(u)("actions.Cancel")),1)]),_:1}),e(O)?(l(),w(x,{key:0,type:"primary",icon:e(At),onClick:we},{default:n(()=>[$(f(e(u)("timeSheets.Submit")),1)]),_:1},8,["icon"])):S("",!0)]),default:n(()=>[T("div",Cr,f(e(u)("timeSheets.confirmSubmit.dialogQuestion")),1),T("div",null,f(e(u)("timeSheets.confirmSubmit.dialogExplanation")),1)]),_:1},8,["model-value","title"])):S("",!0)])),[[ee,!e(at),void 0,{fullscreen:!0,lock:!0}]])}}});export{Pi as default};
