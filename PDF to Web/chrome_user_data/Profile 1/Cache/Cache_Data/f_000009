const __vite__fileDeps=["assets/ContextChat-y4oenQxV.js","assets/ContextChat.vue_vue_type_script_setup_true_lang-CLWrUqWg.js","assets/vendor-DP6O45ke.js","assets/vendor-Bi5_IIMz.css","assets/index-Dsay-W0g.js","assets/index-DNLwZrWR.css","assets/chat.store-WmbfM-QW.js","assets/index-CJWmrMZX.js","assets/computedDebounced-DaN6cEOJ.js","assets/upload.store-CU1g3nY9.js","assets/useServiceEventListener-DCg5b4lA.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{a as Pe,u as Ae,r as j,U as ae,eZ as tt,w as rt,o as R,az as ie,c as C,g as Q,h as W,f as q,e_ as Se,i as De,t as Ee,e as J,aN as nt,j as G,ez as at,eX as it,aO as ot,e$ as Oe,eE as ut,l as st,f0 as ct,eK as ft,$ as lt,a3 as dt,Y as K,D as vt,e1 as gt,aB as Me,ah as ht,aC as pt}from"./vendor-DP6O45ke.js";import{n as mt,A as yt,f as xt}from"./index-Dsay-W0g.js";import{u as Be,a as Le}from"./chat.store-WmbfM-QW.js";import"./index-CJWmrMZX.js";import"./computedDebounced-DaN6cEOJ.js";var Fe={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},se={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},bt=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Y={CSS:{},springs:{}};function O(e,t,r){return Math.min(Math.max(e,t),r)}function Z(e,t){return e.indexOf(t)>-1}function ne(e,t){return e.apply(null,t)}var g={arr:function(e){return Array.isArray(e)},obj:function(e){return Z(Object.prototype.toString.call(e),"Object")},pth:function(e){return g.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||g.svg(e)},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},nil:function(e){return g.und(e)||e===null},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return g.hex(e)||g.rgb(e)||g.hsl(e)},key:function(e){return!Fe.hasOwnProperty(e)&&!se.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function Ve(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function je(e,t){var r=Ve(e),n=O(g.und(r[0])?1:r[0],.1,100),a=O(g.und(r[1])?100:r[1],.1,100),o=O(g.und(r[2])?10:r[2],.1,100),u=O(g.und(r[3])?0:r[3],.1,100),s=Math.sqrt(a/n),i=o/(2*Math.sqrt(a*n)),h=i<1?s*Math.sqrt(1-i*i):0,c=1,d=i<1?(i*s+-u)/h:-u+s;function p(m){var f=t?t*m/1e3:m;return i<1?f=Math.exp(-f*i*s)*(c*Math.cos(h*f)+d*Math.sin(h*f)):f=(c+d*f)*Math.exp(-f*s),m===0||m===1?m:1-f}function _(){var m=Y.springs[e];if(m)return m;for(var f=1/6,y=0,b=0;;)if(y+=f,p(y)===1){if(b++,b>=16)break}else b=0;var l=y*f*1e3;return Y.springs[e]=l,l}return t?p:_}function wt(e){return e===void 0&&(e=10),function(t){return Math.ceil(O(t,1e-6,1)*e)*(1/e)}}var Mt=function(){var e=11,t=1/(e-1);function r(c,d){return 1-3*d+3*c}function n(c,d){return 3*d-6*c}function a(c){return 3*c}function o(c,d,p){return((r(d,p)*c+n(d,p))*c+a(d))*c}function u(c,d,p){return 3*r(d,p)*c*c+2*n(d,p)*c+a(d)}function s(c,d,p,_,m){var f,y,b=0;do y=d+(p-d)/2,f=o(y,_,m)-c,f>0?p=y:d=y;while(Math.abs(f)>1e-7&&++b<10);return y}function i(c,d,p,_){for(var m=0;m<4;++m){var f=u(d,p,_);if(f===0)return d;var y=o(d,p,_)-c;d-=y/f}return d}function h(c,d,p,_){if(!(0<=c&&c<=1&&0<=p&&p<=1))return;var m=new Float32Array(e);if(c!==d||p!==_)for(var f=0;f<e;++f)m[f]=o(f*t,c,p);function y(b){for(var l=0,v=1,w=e-1;v!==w&&m[v]<=b;++v)l+=t;--v;var k=(b-m[v])/(m[v+1]-m[v]),x=l+k*t,I=u(x,c,p);return I>=.001?i(b,x,c,p):I===0?x:s(b,l,l+t,c,p)}return function(b){return c===d&&p===_||b===0||b===1?b:o(y(b),d,_)}}return h}(),ze=function(){var e={linear:function(){return function(n){return n}}},t={Sine:function(){return function(n){return 1-Math.cos(n*Math.PI/2)}},Expo:function(){return function(n){return n?Math.pow(2,10*n-10):0}},Circ:function(){return function(n){return 1-Math.sqrt(1-n*n)}},Back:function(){return function(n){return n*n*(3*n-2)}},Bounce:function(){return function(n){for(var a,o=4;n<((a=Math.pow(2,--o))-1)/11;);return 1/Math.pow(4,3-o)-7.5625*Math.pow((a*3-2)/22-n,2)}},Elastic:function(n,a){n===void 0&&(n=1),a===void 0&&(a=.5);var o=O(n,1,10),u=O(a,.1,2);return function(s){return s===0||s===1?s:-o*Math.pow(2,10*(s-1))*Math.sin((s-1-u/(Math.PI*2)*Math.asin(1/o))*(Math.PI*2)/u)}}},r=["Quad","Cubic","Quart","Quint"];return r.forEach(function(n,a){t[n]=function(){return function(o){return Math.pow(o,a+2)}}}),Object.keys(t).forEach(function(n){var a=t[n];e["easeIn"+n]=a,e["easeOut"+n]=function(o,u){return function(s){return 1-a(o,u)(1-s)}},e["easeInOut"+n]=function(o,u){return function(s){return s<.5?a(o,u)(s*2)/2:1-a(o,u)(s*-2+2)/2}},e["easeOutIn"+n]=function(o,u){return function(s){return s<.5?(1-a(o,u)(1-s*2))/2:(a(o,u)(s*2-1)+1)/2}}}),e}();function ce(e,t){if(g.fnc(e))return e;var r=e.split("(")[0],n=ze[r],a=Ve(e);switch(r){case"spring":return je(e,t);case"cubicBezier":return ne(Mt,a);case"steps":return ne(wt,a);default:return ne(n,a)}}function We(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function X(e,t){for(var r=e.length,n=arguments.length>=2?arguments[1]:void 0,a=[],o=0;o<r;o++)if(o in e){var u=e[o];t.call(n,u,o,e)&&a.push(u)}return a}function ee(e){return e.reduce(function(t,r){return t.concat(g.arr(r)?ee(r):r)},[])}function Ce(e){return g.arr(e)?e:(g.str(e)&&(e=We(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function fe(e,t){return e.some(function(r){return r===t})}function le(e){var t={};for(var r in e)t[r]=e[r];return t}function oe(e,t){var r=le(e);for(var n in e)r[n]=t.hasOwnProperty(n)?t[n]:e[n];return r}function te(e,t){var r=le(e);for(var n in t)r[n]=g.und(e[n])?t[n]:e[n];return r}function Ct(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function Tt(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(s,i,h,c){return i+i+h+h+c+c}),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),a=parseInt(n[1],16),o=parseInt(n[2],16),u=parseInt(n[3],16);return"rgba("+a+","+o+","+u+",1)"}function _t(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,n=parseInt(t[2],10)/100,a=parseInt(t[3],10)/100,o=t[4]||1;function u(p,_,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?p+(_-p)*6*m:m<1/2?_:m<2/3?p+(_-p)*(2/3-m)*6:p}var s,i,h;if(n==0)s=i=h=a;else{var c=a<.5?a*(1+n):a+n-a*n,d=2*a-c;s=u(d,c,r+1/3),i=u(d,c,r),h=u(d,c,r-1/3)}return"rgba("+s*255+","+i*255+","+h*255+","+o+")"}function It(e){if(g.rgb(e))return Ct(e);if(g.hex(e))return Tt(e);if(g.hsl(e))return _t(e)}function F(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function kt(e){if(Z(e,"translate")||e==="perspective")return"px";if(Z(e,"rotate")||Z(e,"skew"))return"deg"}function ue(e,t){return g.fnc(e)?e(t.target,t.id,t.total):e}function B(e,t){return e.getAttribute(t)}function de(e,t,r){var n=F(t);if(fe([r,"deg","rad","turn"],n))return t;var a=Y.CSS[t+r];if(!g.und(a))return a;var o=100,u=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(u),u.style.position="absolute",u.style.width=o+r;var i=o/u.offsetWidth;s.removeChild(u);var h=i*parseFloat(t);return Y.CSS[t+r]=h,h}function Re(e,t,r){if(t in e.style){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),a=e.style[t]||getComputedStyle(e).getPropertyValue(n)||"0";return r?de(e,a,r):a}}function ve(e,t){if(g.dom(e)&&!g.inp(e)&&(!g.nil(B(e,t))||g.svg(e)&&e[t]))return"attribute";if(g.dom(e)&&fe(bt,t))return"transform";if(g.dom(e)&&t!=="transform"&&Re(e,t))return"css";if(e[t]!=null)return"object"}function $e(e){if(g.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,n=new Map,a;a=r.exec(t);)n.set(a[1],a[2]);return n}}function Pt(e,t,r,n){var a=Z(t,"scale")?1:0+kt(t),o=$e(e).get(t)||a;return r&&(r.transforms.list.set(t,o),r.transforms.last=t),n?de(e,o,n):o}function ge(e,t,r,n){switch(ve(e,t)){case"transform":return Pt(e,t,n,r);case"css":return Re(e,t,r);case"attribute":return B(e,t);default:return e[t]||0}}function he(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var n=F(e)||0,a=parseFloat(t),o=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return a+o+n;case"-":return a-o+n;case"*":return a*o+n}}function qe(e,t){if(g.col(e))return It(e);if(/\s/g.test(e))return e;var r=F(e),n=r?e.substr(0,e.length-r.length):e;return t?n+t:n}function pe(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function At(e){return Math.PI*2*B(e,"r")}function St(e){return B(e,"width")*2+B(e,"height")*2}function Dt(e){return pe({x:B(e,"x1"),y:B(e,"y1")},{x:B(e,"x2"),y:B(e,"y2")})}function Ue(e){for(var t=e.points,r=0,n,a=0;a<t.numberOfItems;a++){var o=t.getItem(a);a>0&&(r+=pe(n,o)),n=o}return r}function Et(e){var t=e.points;return Ue(e)+pe(t.getItem(t.numberOfItems-1),t.getItem(0))}function Ne(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return At(e);case"rect":return St(e);case"line":return Dt(e);case"polyline":return Ue(e);case"polygon":return Et(e)}}function Ot(e){var t=Ne(e);return e.setAttribute("stroke-dasharray",t),t}function Bt(e){for(var t=e.parentNode;g.svg(t)&&g.svg(t.parentNode);)t=t.parentNode;return t}function He(e,t){var r=t||{},n=r.el||Bt(e),a=n.getBoundingClientRect(),o=B(n,"viewBox"),u=a.width,s=a.height,i=r.viewBox||(o?o.split(" "):[0,0,u,s]);return{el:n,viewBox:i,x:i[0]/1,y:i[1]/1,w:u,h:s,vW:i[2],vH:i[3]}}function Lt(e,t){var r=g.str(e)?We(e)[0]:e,n=t||100;return function(a){return{property:a,el:r,svg:He(r),totalLength:Ne(r)*(n/100)}}}function Ft(e,t,r){function n(c){c===void 0&&(c=0);var d=t+c>=1?t+c:0;return e.el.getPointAtLength(d)}var a=He(e.el,e.svg),o=n(),u=n(-1),s=n(1),i=r?1:a.w/a.vW,h=r?1:a.h/a.vH;switch(e.property){case"x":return(o.x-a.x)*i;case"y":return(o.y-a.y)*h;case"angle":return Math.atan2(s.y-u.y,s.x-u.x)*180/Math.PI}}function Te(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=qe(g.pth(e)?e.totalLength:e,t)+"";return{original:n,numbers:n.match(r)?n.match(r).map(Number):[0],strings:g.str(e)||t?n.split(r):[]}}function me(e){var t=e?ee(g.arr(e)?e.map(Ce):Ce(e)):[];return X(t,function(r,n,a){return a.indexOf(r)===n})}function Qe(e){var t=me(e);return t.map(function(r,n){return{target:r,id:n,total:t.length,transforms:{list:$e(r)}}})}function Vt(e,t){var r=le(t);if(/^spring/.test(r.easing)&&(r.duration=je(r.easing)),g.arr(e)){var n=e.length,a=n===2&&!g.obj(e[0]);a?e={value:e}:g.fnc(t.duration)||(r.duration=t.duration/n)}var o=g.arr(e)?e:[e];return o.map(function(u,s){var i=g.obj(u)&&!g.pth(u)?u:{value:u};return g.und(i.delay)&&(i.delay=s?0:t.delay),g.und(i.endDelay)&&(i.endDelay=s===o.length-1?t.endDelay:0),i}).map(function(u){return te(u,r)})}function jt(e){for(var t=X(ee(e.map(function(o){return Object.keys(o)})),function(o){return g.key(o)}).reduce(function(o,u){return o.indexOf(u)<0&&o.push(u),o},[]),r={},n=function(o){var u=t[o];r[u]=e.map(function(s){var i={};for(var h in s)g.key(h)?h==u&&(i.value=s[h]):i[h]=s[h];return i})},a=0;a<t.length;a++)n(a);return r}function zt(e,t){var r=[],n=t.keyframes;n&&(t=te(jt(n),t));for(var a in t)g.key(a)&&r.push({name:a,tweens:Vt(t[a],e)});return r}function Wt(e,t){var r={};for(var n in e){var a=ue(e[n],t);g.arr(a)&&(a=a.map(function(o){return ue(o,t)}),a.length===1&&(a=a[0])),r[n]=a}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function Rt(e,t){var r;return e.tweens.map(function(n){var a=Wt(n,t),o=a.value,u=g.arr(o)?o[1]:o,s=F(u),i=ge(t.target,e.name,s,t),h=r?r.to.original:i,c=g.arr(o)?o[0]:h,d=F(c)||F(i),p=s||d;return g.und(u)&&(u=h),a.from=Te(c,p),a.to=Te(he(u,c),p),a.start=r?r.end:0,a.end=a.start+a.delay+a.duration+a.endDelay,a.easing=ce(a.easing,a.duration),a.isPath=g.pth(o),a.isPathTargetInsideSVG=a.isPath&&g.svg(t.target),a.isColor=g.col(a.from.original),a.isColor&&(a.round=1),r=a,a})}var Ze={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,n,a){if(n.list.set(t,r),t===n.last||a){var o="";n.list.forEach(function(u,s){o+=s+"("+u+") "}),e.style.transform=o}}};function Ke(e,t){var r=Qe(e);r.forEach(function(n){for(var a in t){var o=ue(t[a],n),u=n.target,s=F(o),i=ge(u,a,s,n),h=s||F(i),c=he(qe(o,h),i),d=ve(u,a);Ze[d](u,a,c,n.transforms,!0)}})}function $t(e,t){var r=ve(e.target,t.name);if(r){var n=Rt(t,e),a=n[n.length-1];return{type:r,property:t.name,animatable:e,tweens:n,duration:a.end,delay:n[0].delay,endDelay:a.endDelay}}}function qt(e,t){return X(ee(e.map(function(r){return t.map(function(n){return $t(r,n)})})),function(r){return!g.und(r)})}function Ge(e,t){var r=e.length,n=function(o){return o.timelineOffset?o.timelineOffset:0},a={};return a.duration=r?Math.max.apply(Math,e.map(function(o){return n(o)+o.duration})):t.duration,a.delay=r?Math.min.apply(Math,e.map(function(o){return n(o)+o.delay})):t.delay,a.endDelay=r?a.duration-Math.max.apply(Math,e.map(function(o){return n(o)+o.duration-o.endDelay})):t.endDelay,a}var _e=0;function Ut(e){var t=oe(Fe,e),r=oe(se,e),n=zt(r,e),a=Qe(e.targets),o=qt(a,n),u=Ge(o,r),s=_e;return _e++,te(t,{id:s,children:[],animatables:a,animations:o,duration:u.duration,delay:u.delay,endDelay:u.endDelay})}var E=[],Je=function(){var e;function t(){!e&&(!Ie()||!T.suspendWhenDocumentHidden)&&E.length>0&&(e=requestAnimationFrame(r))}function r(a){for(var o=E.length,u=0;u<o;){var s=E[u];s.paused?(E.splice(u,1),o--):(s.tick(a),u++)}e=u>0?requestAnimationFrame(r):void 0}function n(){T.suspendWhenDocumentHidden&&(Ie()?e=cancelAnimationFrame(e):(E.forEach(function(a){return a._onDocumentVisibility()}),Je()))}return typeof document<"u"&&document.addEventListener("visibilitychange",n),t}();function Ie(){return!!document&&document.hidden}function T(e){e===void 0&&(e={});var t=0,r=0,n=0,a,o=0,u=null;function s(l){var v=window.Promise&&new Promise(function(w){return u=w});return l.finished=v,v}var i=Ut(e);s(i);function h(){var l=i.direction;l!=="alternate"&&(i.direction=l!=="normal"?"normal":"reverse"),i.reversed=!i.reversed,a.forEach(function(v){return v.reversed=i.reversed})}function c(l){return i.reversed?i.duration-l:l}function d(){t=0,r=c(i.currentTime)*(1/T.speed)}function p(l,v){v&&v.seek(l-v.timelineOffset)}function _(l){if(i.reversePlayback)for(var w=o;w--;)p(l,a[w]);else for(var v=0;v<o;v++)p(l,a[v])}function m(l){for(var v=0,w=i.animations,k=w.length;v<k;){var x=w[v],I=x.animatable,A=x.tweens,P=A.length-1,M=A[P];P&&(M=X(A,function(et){return l<et.end})[0]||M);for(var D=O(l-M.start-M.delay,0,M.duration)/M.duration,L=isNaN(D)?1:M.easing(D),S=M.to.strings,V=M.round,z=[],Xe=M.to.numbers.length,$=void 0,U=0;U<Xe;U++){var N=void 0,ye=M.to.numbers[U],xe=M.from.numbers[U]||0;M.isPath?N=Ft(M.value,L*ye,M.isPathTargetInsideSVG):N=xe+L*(ye-xe),V&&(M.isColor&&U>2||(N=Math.round(N*V)/V)),z.push(N)}var be=S.length;if(!be)$=z[0];else{$=S[0];for(var H=0;H<be;H++){S[H];var we=S[H+1],re=z[H];isNaN(re)||(we?$+=re+we:$+=re+" ")}}Ze[x.type](I.target,x.property,$,I.transforms),x.currentValue=$,v++}}function f(l){i[l]&&!i.passThrough&&i[l](i)}function y(){i.remaining&&i.remaining!==!0&&i.remaining--}function b(l){var v=i.duration,w=i.delay,k=v-i.endDelay,x=c(l);i.progress=O(x/v*100,0,100),i.reversePlayback=x<i.currentTime,a&&_(x),!i.began&&i.currentTime>0&&(i.began=!0,f("begin")),!i.loopBegan&&i.currentTime>0&&(i.loopBegan=!0,f("loopBegin")),x<=w&&i.currentTime!==0&&m(0),(x>=k&&i.currentTime!==v||!v)&&m(v),x>w&&x<k?(i.changeBegan||(i.changeBegan=!0,i.changeCompleted=!1,f("changeBegin")),f("change"),m(x)):i.changeBegan&&(i.changeCompleted=!0,i.changeBegan=!1,f("changeComplete")),i.currentTime=O(x,0,v),i.began&&f("update"),l>=v&&(r=0,y(),i.remaining?(t=n,f("loopComplete"),i.loopBegan=!1,i.direction==="alternate"&&h()):(i.paused=!0,i.completed||(i.completed=!0,f("loopComplete"),f("complete"),!i.passThrough&&"Promise"in window&&(u(),s(i)))))}return i.reset=function(){var l=i.direction;i.passThrough=!1,i.currentTime=0,i.progress=0,i.paused=!0,i.began=!1,i.loopBegan=!1,i.changeBegan=!1,i.completed=!1,i.changeCompleted=!1,i.reversePlayback=!1,i.reversed=l==="reverse",i.remaining=i.loop,a=i.children,o=a.length;for(var v=o;v--;)i.children[v].reset();(i.reversed&&i.loop!==!0||l==="alternate"&&i.loop===1)&&i.remaining++,m(i.reversed?i.duration:0)},i._onDocumentVisibility=d,i.set=function(l,v){return Ke(l,v),i},i.tick=function(l){n=l,t||(t=n),b((n+(r-t))*T.speed)},i.seek=function(l){b(c(l))},i.pause=function(){i.paused=!0,d()},i.play=function(){i.paused&&(i.completed&&i.reset(),i.paused=!1,E.push(i),d(),Je())},i.reverse=function(){h(),i.completed=!i.reversed,d()},i.restart=function(){i.reset(),i.play()},i.remove=function(l){var v=me(l);Ye(v,i)},i.reset(),i.autoplay&&i.play(),i}function ke(e,t){for(var r=t.length;r--;)fe(e,t[r].animatable.target)&&t.splice(r,1)}function Ye(e,t){var r=t.animations,n=t.children;ke(e,r);for(var a=n.length;a--;){var o=n[a],u=o.animations;ke(e,u),!u.length&&!o.children.length&&n.splice(a,1)}!r.length&&!n.length&&t.pause()}function Nt(e){for(var t=me(e),r=E.length;r--;){var n=E[r];Ye(t,n)}}function Ht(e,t){t===void 0&&(t={});var r=t.direction||"normal",n=t.easing?ce(t.easing):null,a=t.grid,o=t.axis,u=t.from||0,s=u==="first",i=u==="center",h=u==="last",c=g.arr(e),d=parseFloat(c?e[0]:e),p=c?parseFloat(e[1]):0,_=F(c?e[1]:e)||0,m=t.start||0+(c?d:0),f=[],y=0;return function(b,l,v){if(s&&(u=0),i&&(u=(v-1)/2),h&&(u=v-1),!f.length){for(var w=0;w<v;w++){if(!a)f.push(Math.abs(u-w));else{var k=i?(a[0]-1)/2:u%a[0],x=i?(a[1]-1)/2:Math.floor(u/a[0]),I=w%a[0],A=Math.floor(w/a[0]),P=k-I,M=x-A,D=Math.sqrt(P*P+M*M);o==="x"&&(D=-P),o==="y"&&(D=-M),f.push(D)}y=Math.max.apply(Math,f)}n&&(f=f.map(function(S){return n(S/y)*y})),r==="reverse"&&(f=f.map(function(S){return o?S<0?S*-1:-S:Math.abs(y-S)}))}var L=c?(p-d)/y:d;return m+L*(Math.round(f[l]*100)/100)+_}}function Qt(e){e===void 0&&(e={});var t=T(e);return t.duration=0,t.add=function(r,n){var a=E.indexOf(t),o=t.children;a>-1&&E.splice(a,1);function u(p){p.passThrough=!0}for(var s=0;s<o.length;s++)u(o[s]);var i=te(r,oe(se,e));i.targets=i.targets||e.targets;var h=t.duration;i.autoplay=!1,i.direction=t.direction,i.timelineOffset=g.und(n)?h:he(n,h),u(t),t.seek(i.timelineOffset);var c=T(i);u(c),o.push(c);var d=Ge(o,e);return t.delay=d.delay,t.endDelay=d.endDelay,t.duration=d.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}T.version="3.2.1";T.speed=1;T.suspendWhenDocumentHidden=!0;T.running=E;T.remove=Nt;T.get=ge;T.set=Ke;T.convertPx=de;T.path=Lt;T.setDashoffset=Ot;T.stagger=Ht;T.timeline=Qt;T.easing=ce;T.penner=ze;T.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};const Zt={key:0,class:"bg-white shadow-xl drop-shadow-xl drop-shadow-2xl rounded-lg flex flex-col relative"},Kt={class:"mx-3 my-3 flex justify-between"},Gt={class:"flex w-full h-16"},Jt=ot(()=>xt(()=>import("./ContextChat-y4oenQxV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),Yt=Pe({__name:"GlobalChat",props:{context:{type:Object,required:!0},chat:{type:Object,required:!0},mobileModus:{type:Boolean,required:!0},id:{type:String,required:!0}},emits:["open","width"],setup(e,{expose:t,emit:r}){const n=e,a=r,{t:o}=Ae(),u=Be(),s=j(),i=j(),h=j(!1),c=j(!1),d=j("137px"),p=j(0),_=j(0),m=mt().createScope(),{data:f}=m.useGet({id:()=>n.context.assignmentId,lazy:!0}),{call:y}=Le(async(x,I)=>{x&&(a("open"),n.chat.lastAccess=new Date,await w()),await T({targets:i.value,maxWidth:x?"470px":"0px",width:"100%",height:x?"600px":"0px",easing:"easeInOutQuad",duration:.4*1e3}).finished,s.value&&(p.value=parseFloat(getComputedStyle(s.value).width.replaceAll("px",""))),x&&(c.value=!0)});ae([h,()=>n.mobileModus],([x,I])=>{y(x,I)});let b=!1;ae([()=>!!f.value,i,s],([x,I,A])=>{if(x&&I&&(d.value=getComputedStyle(I).width),x&&A&&!b){const P=parseFloat(getComputedStyle(A).width.replaceAll("px",""));a("width",P),p.value=P,_.value=P,b=!0}});function l(){h.value=!1}const{hasUnreadMessages:v,markAsRead:w}=u.useHasUnreadChatMessages(n.context),{isOutside:k}=tt(s);return rt(()=>!k.value&&v.value&&h.value,()=>{w()}),t({close:l,currentWidth:p,open:h}),(x,I)=>{const A=Oe,P=ut,M=st,D=ct;return R(),ie("div",{ref_key:"chatTabRef",ref:s,class:"max-w-full"},[C(f)?(R(),ie("div",Zt,[Q("div",Kt,[W(P,{value:"!",hidden:!C(v)},{default:q(()=>[Q("div",{class:"cursor-pointer max-w-[230px] overflow-hidden text-ellipsis",onClick:I[0]||(I[0]=L=>h.value=!C(h))},[W(A,null,{default:q(()=>[W(C(Se))]),_:1}),De(" "+Ee(C(f).name),1)])]),_:1},8,["hidden"]),W(yt,{content:C(o)("actions.Close")},{default:q(()=>[C(h)?(R(),J(M,{key:0,text:"",icon:C(nt),onClick:I[1]||(I[1]=L=>C(u).closeChat(e.id))},null,8,["icon"])):G("",!0)]),_:1},8,["content"])]),Q("div",{ref_key:"widthAnimationTarget",ref:i},[C(c)?(R(),J(it,{key:0},{fallback:q(()=>[at(Q("div",Gt,null,512),[[D,!0]])]),default:q(()=>[W(C(Jt),{context:e.context,class:"block"},null,8,["context"])]),_:1})):G("",!0)],512)])):G("",!0)],512)}}}),ar=Pe({__name:"ArtesaChatProvider",setup(e){const{t}=Ae(),r=j(!1),n=Be(),{width:a}=ft(document.querySelector("body")),o=lt(new Map),u=dt(new Map),s=K(()=>{const f=[...n.chats];return f.sort((y,b)=>new Date(b.lastAccess).getTime()-new Date(y.lastAccess).getTime()),f.map(y=>y.id)}),i=10,h=K(()=>[...o.values()].map(f=>f.currentWidth).reduce((f,y)=>f+y+i,0)),c=K(()=>h.value>a.value),d=K(()=>s.value.some(f=>m(f))),{call:p}=Le(async(f,y,b,l)=>{const v=[...f].reverse(),w=[];for(const[k,x]of v.entries()){const A=v.filter((V,z)=>z<k).map(V=>y.get(V)).reduce((V,z)=>(V??0)+(z??0)+i,0),P=o.get(x),M=P?.open;let D=A??0,L=0,S=b&&!M?0:1;b&&M&&(D=0),l&&b&&!d.value&&(D=0,L=(48+i)*(k+1),S=1),w.push(T({targets:P?.$el,right:D,bottom:L,duration:.2*1e3,easing:"easeInQuad",opacity:S}).finished)}await Promise.all(w)});ae([s,()=>new Map(u),c,r,d],([f,y,b,l,v],[w,k,x,I,A])=>{vt(f,w)&&[...y.values()].length===[...k.values()].length&&b===x&&l===I&&v===A||p([...f],new Map(y),b,l)});function _(f){for(const y of n.chats)y.id!==f&&o.has(y.id)&&o.get(y.id)?.close()}function m(f){return o.get(f)?.open}return(f,y)=>{const b=Oe;return C(n).chats.length?(R(),J(pt,{key:0,to:"body"},[(R(!0),ie(ht,null,gt(C(n).chats,l=>(R(),J(Yt,{id:l.id,key:l.id,ref_for:!0,ref:v=>v&&C(o).set(l.id,v),chat:l,context:l.context,"mobile-modus":C(c),class:Me([{"pointer-events-none":C(c)&&!m(l.id)&&!C(r)},"fixed z-[10000] bottom-0"]),onOpen:()=>_(l.id),onWidth:v=>!C(u).has(l.id)&&C(u).set(l.id,v)},null,8,["id","chat","context","mobile-modus","class","onOpen","onWidth"]))),128)),Q("div",{class:Me([{hidden:!C(c)||[...C(o).values()].some(l=>l.open)},"fixed z-[10000000] bottom-0 right-3 bg-white shadow-xl p-3 rounded-lg"]),onClick:y[0]||(y[0]=l=>r.value=!C(r))},[W(b,null,{default:q(()=>[W(C(Se))]),_:1}),De(" "+Ee(C(t)("chat.openChats")),1)],2)])):G("",!0)}}});export{ar as default};
